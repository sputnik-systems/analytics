"use strict";const Cs=require("obsidian");function Ko(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const de=Ko(Cs);function Zo(t){const e="metadataTypeManager"in t?t.metadataTypeManager:void 0;if(!e){console.warn("[Timeline View] Could not find metadataTypeManager in app");return}if(typeof e!="object"){console.warn("[Timeline View] MetadataTypeManager is not an object in app");return}if(!Jo(e)){console.warn("[Timeline View] MetadataTypeManager is not of expected shape in app");return}return e}function Jo(t){return!("properties"in t)||!t.properties?(console.warn("[Timeline View] MetadataTypeManager does not have properties"),!1):typeof t.properties!="object"?(console.warn("[Timeline View] MetadataTypeManager.properties is not an object"),!1):$o(t.properties)?!("types"in t)||!t.types?(console.warn("[Timeline View] MetadataTypeManager does not have types"),!1):typeof t.types!="object"?(console.warn("[Timeline View] MetadataTypeManager.types is not an object"),!1):ea(t.types)?!0:(console.warn("[Timeline View] MetadataTypeManager.types is not of expected shape"),!1):(console.warn("[Timeline View] MetadataTypeManager.properties is not of expected shape"),!1)}function $o(t){if(!("aliases"in t)||t.aliases===null)return console.warn("[Timeline View] MetadataTypeManager.properties.aliases is null or undefined"),!1;if(!er("aliases",t.aliases))return console.warn("[Timeline View] MetadataTypeManager.properties.aliases is not of expected shape"),!1;if(t.aliases,!("cssclasses"in t)||t.cssclasses===null)return console.warn("[Timeline View] MetadataTypeManager.properties.cssclasses is null or undefined"),!1;if(!er("cssclasses",t.cssclasses))return console.warn("[Timeline View] MetadataTypeManager.properties.cssclasses is not of expected shape"),!1;if(t.cssclasses,!("tags"in t)||t.tags===null)return console.warn("[Timeline View] MetadataTypeManager.properties.tags is null or undefined"),!1;if(!er("tags",t.tags))return console.warn("[Timeline View] MetadataTypeManager.properties.tags is not of expected shape"),!1;t.tags;for(const[e,n]of Object.entries(t))if(!er(e,n))return console.warn(`[Timeline View] MetadataTypeManager.properties.${e} is not of expected shape`),!1;return!0}function er(t,e){return typeof e!="object"||e===null?(console.warn(`[Timeline View] MetadataTypeManager.properties.${t} is not an object`),!1):!("name"in e)||!("type"in e)||!("count"in e)?(console.warn(`[Timeline View] MetadataTypeManager.properties.${t} is missing "name", "type", or "count"`),!1):typeof e.name!="string"?(console.warn(`[Timeline View] MetadataTypeManager.properties.${t}.name is not a string
Found: ${e.name}`),!1):e.type!==void 0&&typeof e.type!="string"?(console.warn(`[Timeline View] MetadataTypeManager.properties.${t}.type is not a string
Found: ${e.type}`),!1):typeof e.count!="number"?(console.warn(`[Timeline View] MetadataTypeManager.properties.${t}.count is not a number
Found: ${e.count}`),!1):!0}function ea(t){if(!("aliases"in t)||!("cssclasses"in t)||!("tags"in t)||!tr("aliases",t.aliases)&&!tr("cssclasses",t.cssclasses)&&!tr("tags",t.tags))return!1;for(const[e,n]of Object.entries(t))if(!tr(e,n))return!1;return!0}function tr(t,e){return!(typeof e!="object"||e===null||!("name"in e)||!("type"in e)||typeof e.name!="string"||typeof e.type!="string")}class Bi{constructor(e,n){this.#e=e,this.#t=n}#e;name(){return this.#e}#t;type(){return this.#t}selectFrom(e){return e.properties()[this.#e]}}class ta{constructor(e,n){this.readPropertyTypes=e,this.#e=()=>{const r=n();return r&&(this.#e=()=>r),r}}#e;async getPropertyByName(e){return(await this.#t()).find(r=>r.name()===e)??null}async listPropertiesOfTypes(e){const n=this.#e()?.properties;if(n){const r=[];for(const i of Object.values(n))e.includes(i.type)&&r.push(new Bi(i.name,i.type));return r}else return(await this.#t()).filter(i=>e.includes(i.type()))}async#t(){let e={};try{const i=await this.readPropertyTypes();e=JSON.parse(i)}catch(i){console.error("[Timeline View]",i)}const n=[];if(!("types"in e))return n;const r=e.types;if(r==null||typeof r!="object")return n;for(const[i,o]of Object.entries(r))typeof o=="string"&&n.push(new Bi(i,o));return n}}function yn(t){return t!=null&&typeof t=="object"&&"appliesTo"in t&&typeof t.appliesTo=="function"}function sn(t,e){return t=Array.isArray(t)?et(t):t,e=Array.isArray(e)?et(e):e,new na(t,e)}class na{constructor(e,n){this.a=e,this.b=n}async appliesTo(e){return await this.a.appliesTo(e)||await this.b.appliesTo(e)}and(e){return et(this,e)}or(e){return sn(this,e)}}function et(...t){return t.length===1&&Array.isArray(t[0])?qi(t[0]):qi(t)}function qi(t){return t.length===1?t[0]:t.length===0?ra:Ct.flattened(t)}const ra={async appliesTo(t){return!1},and(t){return this},or(t){return t}};class Ct{constructor(e){this.filters=e}static flattened(e){return e.some(n=>n instanceof Ct)?new Ct(e.flatMap(n=>n instanceof Ct?n.filters:[n])):new Ct(e)}async appliesTo(e){return Promise.all(this.filters.map(n=>n.appliesTo(e))).then(n=>n.every(r=>r))}and(e){return e instanceof Ct?new Ct(this.filters.concat(e.filters)):new Ct(this.filters.concat(e))}or(e){return sn(this,e)}}class Ss{constructor(e){this.checker=e}async appliesTo(e){const n=await e.vault.cachedRead(e);return this.checker.matches(n)}and(e){return et(this,e)}or(e){return sn(this,e)}}function Un(t){return"containsNestedGroupParser"in t&&typeof t.containsNestedGroupParser=="function"}function Ms(t){return t!=null&&typeof t=="object"&&"matches"in t&&typeof t.matches=="function"}class ia{constructor(e){this.checker=e}async appliesTo(e){return this.checker.matches(e.basename)}and(e){return et(this,e)}or(e){return sn(this,e)}}class sa{constructor(e){this.checker=e}async appliesTo(e){return this.checker.matches(e.path)}and(e){return et(this,e)}or(e){return et(this,e)}}class kn{constructor(e,n){this.a=e,this.b=n}matches(e){return this.a.matches(e)||this.b.matches(e)}or(e){return new kn(this,e)}and(e){return ct(this,e)}}function ct(...t){return t.length===1&&Array.isArray(t[0])?Hi(t[0]):Hi(t)}function Hi(t){return t.length===1?t[0]:new oa(t)}let oa=class{constructor(e){this.checkers=e}matches(e){return this.checkers.every(n=>n.matches(e))}or(e){return new kn(this,e)}and(e){return ct(this.checkers.concat([e]))}};class Is{constructor(e,n=!0){this.phrase=e,this.matchCase=n}matches(e){return this.matchCase?e.includes(this.phrase):e.toLocaleUpperCase().includes(this.phrase.toLocaleUpperCase())}or(e){return new kn(this,e)}and(e){return ct(this,e)}}class wn{constructor(e=!0,n=""){this.matchCase=e,this.buffer=n}parse(e){switch(e){case"\\":return new aa(this.buffer,this.matchCase);case'"':return null}return new wn(this.matchCase,this.buffer+e)}end(){if(this.buffer.length>0)return new Is(this.buffer,this.matchCase)}}class aa extends wn{constructor(e,n=!0){super(n,e)}parse(e){return new wn(this.matchCase,this.buffer+e)}}function la(t){return t instanceof Ui?t.not():new Ui(t)}class Ui{constructor(e){this.checker=e}matches(e){return!this.checker.matches(e)}not(){return this.checker}or(e){return new kn(this,e)}and(e){return ct(this,e)}}const ua=Is;class Xn{constructor(e,n){this.buffer=e,this.matchCase=n}parse(e){return e===" "?null:new Xn(this.buffer+e,this.matchCase)}end(){if(this.buffer.length>0)return new ua(this.buffer,this.matchCase)}}class Dn{constructor(e,n,r,i=new gt(r)){this.aChecker=e,this.bChecker=n,this.matchCase=r,this.internalParser=i}static start(e,n=!0){return new Dn(e,ct(),n)}parse(e){const n=this.internalParser.parse(e);return n==null?new Dn(this.aChecker,this.nextChecker(),this.matchCase,new gt(this.matchCase)):new Dn(this.aChecker,this.bChecker,this.matchCase,n)}nextChecker(){const e=this.internalParser.end();return e!=null?this.bChecker.and(e):this.bChecker}end(){return this.aChecker.or(this.nextChecker())}}class ht{constructor(e,n,r){this.internalCheckers=e,this.internalParser=n,this.matchCase=r}static start(e){return new ht([],new gt(e),e)}parse(e){if(e===")"&&!this.containsNestedGroupParser())return null;const n=this.internalParser.parse(e);if(n!=null)return new ht(this.internalCheckers,n,this.matchCase);if(this.internalParser instanceof Xn)switch(this.internalParser.buffer.toLocaleLowerCase()){case"or":return new ht([],Dn.start(ct(this.internalCheckers),this.matchCase),this.matchCase);case"and":return new ht(this.internalCheckers,new gt(this.matchCase),this.matchCase)}return new ht(this.endInternalParser(),new gt(this.matchCase),this.matchCase)}containsNestedGroupParser(){return this.internalParser instanceof ht||Un(this.internalParser)&&this.internalParser.containsNestedGroupParser()}endInternalParser(){const e=this.internalParser.end();return e!=null?this.internalCheckers.concat([e]):this.internalCheckers}end(){return ct(this.endInternalParser())}}class ni{constructor(e,n=new gt(e)){this.matchCase=e,this.internalParser=n}parse(e){const n=this.internalParser.parse(e);return n==null?null:new ni(this.matchCase,n)}containsNestedGroupParser(){return this.internalParser instanceof ht||Un(this.internalParser)&&this.internalParser.containsNestedGroupParser()}end(){const e=this.internalParser.end();if(Ms(e))return la(e)}}class gt{constructor(e){this.matchCase=e}parse(e){switch(e){case"-":return new ni(this.matchCase);case'"':return new wn(this.matchCase);case"(":return ht.start(this.matchCase);case" ":return this;default:return new Xn(e,this.matchCase)}}end(){}}class ca{constructor(e){this.checker=e}appliesTo(e){const n=e?.tags;if(n!=null&&n.some(i=>this.checker.matches(`#${i.tag}`)))return!0;const r=e?.frontmatter;return r==null?!1:!!(this.checkTags(r.tag)||this.checkTags(r.tags))}checkTags(e){if(e==null)return!1;if(typeof e=="string")return this.checker.matches(e);if(Array.isArray(e))return e.some(r=>this.checker.matches(r))}}class fa{constructor(e,n){this.metadata=n,this.metadataFilter=new ca(e)}metadataFilter;async appliesTo(e){const n=this.metadata.getFileCache(e);return this.metadataFilter.appliesTo(n)}and(e){return et(this,e)}or(e){return sn(this,e)}}class cr{constructor(e,n,r,i){this.operator=e,this.metadata=n,this.internalParser=r,this.matchCase=i}static start(e,n,r){return new cr(e,n,new gt(r),r)}parse(e){if(this.operator==="tag"&&e==="#")return this;const n=this.internalParser.parse(e);return n==null?null:new cr(this.operator,this.metadata,n,this.matchCase)}containsNestedGroupParser(){return this.internalParser instanceof ht||Un(this.internalParser)&&this.internalParser.containsNestedGroupParser()}end(e){const n=this.internalParser.end();if(Ms(n))switch(this.operator){case"file":return e.and(new ia(n));case"path":return e.and(new sa(n));case"content":return e.and(new Ss(n));case"tag":return e.and(new fa(n,this.metadata))}return e}}class da{constructor(e,n){this.property=e,this.value=n}appliesTo(e){const n=e?.frontmatter;if(n==null)return!1;const r=Object.keys(n).filter(i=>this.property.matches(i));return r.length===0?!1:this.value==null?!0:r.some(i=>{const o=n[i]?.toString();return o==null?!1:this.value.matches(o)})}}class Vs{constructor(e,n,r){this.metadata=e,this.metadataFilter=new da(n,r)}metadataFilter;async appliesTo(e){const n=this.metadata.getFileCache(e);return this.metadataFilter.appliesTo(n)}and(e){return et(this,e)}or(e){return sn(this,e)}}function ha(t){return Array.isArray(t)?Xi(et(t)):Xi(t)}function Xi(t){return t instanceof ji?t.negate():new ji(t)}class ji{constructor(e){this.negated=e}async appliesTo(e){return!this.negated.appliesTo(e)}negate(){return this.negated}and(e){return et(this,e)}or(e){return sn(this,e)}}class mn{constructor(e,n,r,i=[],o=new qt(e,n,r)){this.metadata=e,this.filterType=n,this.matchCase=r,this.collectedBFilters=i,this.internalParser=o}static start(e,n,r){return new mn(e,n,r)}parse(e){const n=this.internalParser.parse(e);if(n==null){const r=this.internalParser.end(bn);return yn(r)?new mn(this.metadata,this.filterType,this.matchCase,this.collectedBFilters.concat([r])):new mn(this.metadata,this.filterType,this.matchCase)}return new mn(this.metadata,this.filterType,this.matchCase,this.collectedBFilters,n)}end(e){const n=this.internalParser.end(bn);return yn(n)?e.or(et(this.collectedBFilters.concat([n]))):e}}class fr{constructor(e,n,r,i){this.subParser=e,this.filterType=n,this.metadata=r,this.matchCase=i}static start(e,n,r,i){return new fr(new Xn(e,i),n,r,i)}get buffer(){return this.subParser.buffer}parse(e){if(e===":"){const r=this.subParser.buffer;switch(r){case"file":case"path":case"content":case"tag":return cr.start(r,this.metadata,this.matchCase)}return new qt(this.metadata)}const n=this.subParser.parse(e);if(n==null){switch(this.buffer.toLocaleLowerCase()){case"or":return mn.start(this.metadata,this.filterType,this.matchCase);case"and":return new qt(this.metadata)}return null}return new fr(n,this.filterType,this.metadata,this.matchCase)}end(e){const n=this.subParser.end();return n!=null?e.and(this.filterType(n)):e}}class $t{constructor(e,n,r,i,o){this.metadata=e,this.filterType=n,this.internalFilter=r,this.internalParser=i,this.matchCase=o}static start(e,n,r){return new $t(e,n,bn,new qt(e,n,r),r)}parse(e){if(e===")"&&!this.containsNestedGroupParser())return null;const n=this.internalParser.parse(e);if(n!=null)return new $t(this.metadata,this.filterType,this.internalFilter,n,this.matchCase);{const r=this.endInternalParser();return new $t(this.metadata,this.filterType,r,new qt(this.metadata,this.filterType,this.matchCase),this.matchCase)}}containsNestedGroupParser(){return this.internalParser instanceof $t||Un(this.internalParser)&&this.internalParser.containsNestedGroupParser()}endInternalParser(){const e=this.internalParser.end(this.internalFilter);return yn(e)?e:this.internalFilter}end(e){const n=this.endInternalParser();return e.and(n)}}class dr{constructor(e,n,r,i){this.metadata=e,this.filterType=n,this.internalParser=r,this.matchCase=i}static start(e,n,r){return new dr(e,n,new qt(e,n,r),r)}parse(e){const n=this.internalParser.parse(e);return n==null?null:new dr(this.metadata,this.filterType,n,this.matchCase)}containsNestedGroupParser(){return this.internalParser instanceof $t||Un(this.internalParser)&&this.internalParser.containsNestedGroupParser()}end(e){const n=this.internalParser.end(bn);return yn(n)?e.and(ha(n)):e}}class ma{constructor(e,n=!0){this.filterType=e,this.subParser=new wn(n)}subParser;parse(e){const n=this.subParser.parse(e);return n==null?null:(this.subParser=n,this)}end(e){const n=this.subParser.end();return n!=null?e.and(this.filterType(n)):e}}function pa(t,e=!1){return typeof t=="string"||t instanceof RegExp?new Gi(new RegExp(t)):new Gi(new RegExp(t.join("")))}class Gi{regex;constructor(e,n=!1){n&&e.flags.includes("i")?this.regex=new RegExp(e,e.flags.split("").filter(r=>r!=="i").join("")):!n&&!e.flags.includes("i")?this.regex=new RegExp(e,e.flags+"i"):this.regex=e}matches(e){return this.regex.test(e)}or(e){return new kn(this,e)}and(e){return ct(this,e)}}class va{constructor(e=!0){this.matchCase=e}escaped=!1;buffer="";parse(e){switch(e){case"\\":if(!this.escaped)return this.escaped=!0,this;case"/":if(!this.escaped)return null}return this.escaped=!1,this.buffer+=e,this}end(){if(this.buffer.length>0)return pa(this.buffer,this.matchCase)}}class ga{constructor(e,n=!0){this.filterType=e,this.subParser=new va(n)}subParser;parse(e){const n=this.subParser.parse(e);return n==null?null:(this.subParser=n,this)}end(e){const n=this.subParser.end();return n!=null?e.and(this.filterType(n)):e}}function ya(t){return new hr([],t)}class hr{constructor(e,n,r=new gt){this.checkers=e,this.metadata=n,this.parser=r}parse(e){if(e==="]")return null;if(e===":")return new mr(ct(this.endInternalParser()),this.metadata);const n=this.parser.parse(e);return n==null?new hr(this.endInternalParser(),this.metadata):new hr(this.checkers,this.metadata,n)}endInternalParser(){const e=this.parser.end();return e!=null?this.checkers.concat([e]):this.checkers}end(e){return e.and(new Vs(this.metadata,ct(this.endInternalParser())))}}class mr{constructor(e,n,r=[],i=new gt){this.property=e,this.metadata=n,this.checkers=r,this.parser=i}parse(e){if(e==="]")return null;const n=this.parser.parse(e);return n==null?new mr(this.property,this.metadata,this.endInternalParser(),new gt):new mr(this.property,this.metadata,this.checkers,n)}endInternalParser(){const e=this.parser.end();return e!=null?this.checkers.concat([e]):this.checkers}end(e){return e.and(new Vs(this.metadata,this.property,ct(this.endInternalParser())))}}class qt{constructor(e,n=i=>new Ss(i),r){this.metadata=e,this.filterType=n,this.matchCase=r}parse(e){switch(e){case"-":return dr.start(this.metadata,this.filterType,this.matchCase);case'"':return new ma(this.filterType,this.matchCase);case"/":return new ga(this.filterType,this.matchCase);case"(":return $t.start(this.metadata,this.filterType,this.matchCase);case"[":return ya(this.metadata);case" ":return null;default:return fr.start(e,this.filterType,this.metadata,this.matchCase)}}end(e){return e}}const bn={async appliesTo(t){return!1},and(t){return t},or(t){return t}};function Ar(t,e,n=bn){t=t.trim();let r=new qt(e);for(const o of t){const a=r.parse(o);if(a==null){const u=r.end(n);yn(u)&&(n=u),r=new qt(e)}else r=a}const i=r.end(n);return yn(i)?i:n}function nr(t){if(t!==void 0)return Math.trunc(t)}function ri(t){return t!=null}class wa{#e;#t;#n;constructor(e,n,r){this.#e=e,this.#t=n,this.#n=r}async createNote(e){let n=0,r="Untitled.md";for(;await this.#e.adapter.exists(r);)n++,r=`Untitled ${n}.md`;const i=await this.#e.create(r,"",{ctime:nr(e.created),mtime:nr(e.modified)});return e.properties&&await this.#n.processFrontMatter(i,o=>{Object.assign(o,e.properties)}),new Jt(i,this.#t)}async modifyNote(e,n){const r=this.getFileFromNote(e);if(r!=null&&((n.created!=null||n.modified!=null)&&await this.#e.adapter.write(r.path,await this.#e.adapter.read(r.path),{ctime:nr(n.created),mtime:nr(n.modified)}),n.properties!=null)){const i=n.properties;await this.#n.processFrontMatter(r,o=>{for(const[a,u]of Object.entries(i))o[a]=u})}}getNoteForFile(e){return new Jt(e,this.#t)}getFileFromNote(e){return e instanceof Jt?e.file():null}listAll(){const e=this.#e,n=this.#t;return function*(){for(const r of e.getMarkdownFiles())yield new Jt(r,n)}()}async listAllMatchingFilter(e){const n=this.#e,r=this.#t,i=e instanceof rr?async a=>await e.fileFilter().appliesTo(a)?new Jt(a,r):null:async a=>{const u=new Jt(a,r);return await e.matches(u)?u:null};return(await Promise.all(n.getMarkdownFiles().map(i))).filter(ri)}getNoteFilterForQuery(e){return new rr(Ar(e,this.#t,Qi),e)}getInclusiveNoteFilterForQuery(e){return new rr(Ar(e,this.#t,Qi),e)}getExclusiveNoteFilterForQuery(e){return new rr(Ar(e,this.#t,bn),e)}}class rr{#e;constructor(e,n){this.#e=e,this.#t=n}fileFilter(){return this.#e}#t;query(){return this.#t}async matches(e){return e instanceof Jt?await this.#e.appliesTo(e.file()):!1}}class Jt{#e;#t;constructor(e,n){this.#e=e,this.#t=n}id(){return this.#e.path}file(){return this.#e}name(){return this.#e.basename}created(){return this.#e.stat.ctime}modified(){return this.#e.stat.mtime}properties(){return this.#t.getFileCache(this.#e)?.frontmatter??{}}}const Qi={async appliesTo(t){return!0},and(t){return t},or(t){return t}};async function ba(t,e,n){const r=Array.from(await t.listAllMatchingFilter(n));e.sortNotes(r);const i=r.at(0),o=r.at(-1),a=i?e.selectValueFromNote(i)??0:0,l=(o?e.selectValueFromNote(o)??a:a)-a;return{focalValue:a+l/2,filter:n,order:e}}const Ur=!1;var Cn=Array.isArray,_a=Array.prototype.indexOf,ii=Array.from,Ns=Object.defineProperty,Yt=Object.getOwnPropertyDescriptor,Es=Object.getOwnPropertyDescriptors,xa=Object.prototype,Pa=Array.prototype,si=Object.getPrototypeOf;function dn(t){return typeof t=="function"}const ge=()=>{};function Ta(t){for(var e=0;e<t.length;e++)t[e]()}const ft=2,Os=4,Pr=8,Tr=16,Ot=32,Sn=64,pr=128,$e=256,vr=512,He=1024,Pt=2048,on=4096,Nt=8192,kr=16384,Fs=32768,jn=65536,ka=1<<17,Ca=1<<19,Ds=1<<20,yt=Symbol("$state"),Ls=Symbol("legacy props"),Sa=Symbol("");let gr=!1,Xr=[];function As(){gr=!1;const t=Xr.slice();Xr=[],Ta(t)}function Gn(t){gr||(gr=!0,queueMicrotask(As)),Xr.push(t)}function Ma(){gr&&As()}function Rs(t){return t===this.v}function Cr(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ia(t,e){return t!==e}function oi(t){return!Cr(t,this.v)}function Va(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Na(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ea(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Oa(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Fa(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Da(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function La(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Aa(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Ra(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Mn=!1,Wa=!1;function za(){Mn=!0}const ai=1,li=2,Ws=4,Ya=8,Ba=16,qa=1,Ha=2,Ua=4,Xa=8,ja=16,Ga=4,Qa=1,Ka=2,Ye=Symbol();function Za(t){console.warn("https://svelte.dev/e/legacy_recursive_reactive_block")}function Qn(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ce=null;function Ki(t){ce=t}function zs(t){return Ys().get(t)}function Ja(t,e){return Ys().set(t,e),e}function ne(t,e=!1,n){ce={p:ce,c:null,e:null,m:!1,s:t,x:null,l:null},Mn&&!e&&(ce.l={s:null,u:null,r1:[],r2:Ge(!1)})}function re(t){const e=ce;if(e!==null){t!==void 0&&(e.x=t);const a=e.e;if(a!==null){var n=ae,r=fe;e.e=null;try{for(var i=0;i<a.length;i++){var o=a[i];_t(o.effect),bt(o.reaction),Xt(o.fn)}}finally{_t(n),bt(r)}}ce=e.p,e.m=!0}return t||{}}function In(){return!Mn||ce!==null&&ce.l===null}function Ys(t){return ce===null&&Qn(),ce.c??=new Map($a(ce)||void 0)}function $a(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}function Ge(t,e){var n={f:0,v:t,reactions:null,equals:Rs,rv:0,wv:0};return n}function V(t){return el(Ge(t))}function ui(t,e=!1){const n=Ge(t);return e||(n.equals=oi),Mn&&ce!==null&&ce.l!==null&&(ce.l.s??=[]).push(n),n}function el(t){return fe!==null&&!pt&&fe.f&ft&&(wt===null?al([t]):wt.push(t)),t}function y(t,e){return fe!==null&&!pt&&In()&&fe.f&(ft|Tr)&&(wt===null||!wt.includes(t))&&Ra(),jr(t,e)}function jr(t,e){return t.equals(e)||(t.v,t.v=e,t.wv=Zs(),Bs(t,Pt),In()&&ae!==null&&ae.f&He&&!(ae.f&(Ot|Sn))&&(St===null?ll([t]):St.push(t))),e}function Bs(t,e){var n=t.reactions;if(n!==null)for(var r=In(),i=n.length,o=0;o<i;o++){var a=n[o],u=a.f;u&Pt||!r&&a===ae||(dt(a,e),u&(He|$e)&&(u&ft?Bs(a,on):Vr(a)))}}function M(t){var e=ft|Pt,n=fe!==null&&fe.f&ft?fe:null;return ae===null||n!==null&&n.f&$e?e|=$e:ae.f|=Ds,{ctx:ce,deps:null,effects:null,equals:Rs,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??ae}}function _n(t){const e=M(t);return e.equals=oi,e}function qs(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)xt(e[n])}}function tl(t){for(var e=t.parent;e!==null;){if(!(e.f&ft))return e;e=e.parent}return null}function nl(t){var e,n=ae;_t(tl(t));try{qs(t),e=$s(t)}finally{_t(n)}return e}function Hs(t){var e=nl(t),n=(Wt||t.f&$e)&&t.deps!==null?on:He;dt(t,n),t.equals(e)||(t.v=e,t.wv=Zs())}let Us=!1;function C(t,e=null,n){if(typeof t!="object"||t===null||yt in t)return t;const r=si(t);if(r!==xa&&r!==Pa)return t;var i=new Map,o=Cn(t),a=Ge(0);o&&i.set("length",Ge(t.length));var u;return new Proxy(t,{defineProperty(l,c,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Da();var h=i.get(c);return h===void 0?(h=Ge(d.value),i.set(c,h)):y(h,C(d.value,u)),!0},deleteProperty(l,c){var d=i.get(c);if(d===void 0)c in l&&i.set(c,Ge(Ye));else{if(o&&typeof c=="string"){var h=i.get("length"),f=Number(c);Number.isInteger(f)&&f<h.v&&y(h,f)}y(d,Ye),Zi(a)}return!0},get(l,c,d){if(c===yt)return t;var h=i.get(c),f=c in l;if(h===void 0&&(!f||Yt(l,c)?.writable)&&(h=Ge(C(f?l[c]:Ye,u)),i.set(c,h)),h!==void 0){var p=s(h);return p===Ye?void 0:p}return Reflect.get(l,c,d)},getOwnPropertyDescriptor(l,c){var d=Reflect.getOwnPropertyDescriptor(l,c);if(d&&"value"in d){var h=i.get(c);h&&(d.value=s(h))}else if(d===void 0){var f=i.get(c),p=f?.v;if(f!==void 0&&p!==Ye)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return d},has(l,c){if(c===yt)return!0;var d=i.get(c),h=d!==void 0&&d.v!==Ye||Reflect.has(l,c);if(d!==void 0||ae!==null&&(!h||Yt(l,c)?.writable)){d===void 0&&(d=Ge(h?C(l[c],u):Ye),i.set(c,d));var f=s(d);if(f===Ye)return!1}return h},set(l,c,d,h){var f=i.get(c),p=c in l;if(o&&c==="length")for(var v=d;v<f.v;v+=1){var g=i.get(v+"");g!==void 0?y(g,Ye):v in l&&(g=Ge(Ye),i.set(v+"",g))}f===void 0?(!p||Yt(l,c)?.writable)&&(f=Ge(void 0),y(f,C(d,u)),i.set(c,f)):(p=f.v!==Ye,y(f,C(d,u)));var b=Reflect.getOwnPropertyDescriptor(l,c);if(b?.set&&b.set.call(h,d),!p){if(o&&typeof c=="string"){var w=i.get("length"),x=Number(c);Number.isInteger(x)&&x>=w.v&&y(w,x+1)}Zi(a)}return!0},ownKeys(l){s(a);var c=Reflect.ownKeys(l).filter(f=>{var p=i.get(f);return p===void 0||p.v!==Ye});for(var[d,h]of i)h.v!==Ye&&!(d in l)&&c.push(d);return c},setPrototypeOf(){La()}})}function Zi(t,e=1){y(t,t.v+e)}function Ji(t){return t!==null&&typeof t=="object"&&yt in t?t[yt]:t}function rl(t,e){return Object.is(Ji(t),Ji(e))}var $i,Xs,js,Gs;function il(){if($i===void 0){$i=window,Xs=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype;js=Yt(e,"firstChild").get,Gs=Yt(e,"nextSibling").get,t.__click=void 0,t.__className="",t.__attributes=null,t.__styles=null,t.__e=void 0,Text.prototype.__t=void 0}}function Sr(t=""){return document.createTextNode(t)}function xn(t){return js.call(t)}function Mr(t){return Gs.call(t)}function Y(t,e){return xn(t)}function pe(t,e){{var n=xn(t);return n instanceof Comment&&n.data===""?Mr(n):n}}function A(t,e=1,n=!1){let r=t;for(;e--;)r=Mr(r);return r}function sl(t){t.textContent=""}const Qs=0,ol=1;let sr=!1,or=Qs,zn=!1,Yn=null,pn=!1,ci=!1;function es(t){pn=t}function ts(t){ci=t}let en=[],vn=0;let fe=null,pt=!1;function bt(t){fe=t}let ae=null;function _t(t){ae=t}let wt=null;function al(t){wt=t}let qe=null,je=0,St=null;function ll(t){St=t}let Ks=1,yr=0,Wt=!1;function Zs(){return++Ks}function Kn(t){var e=t.f;if(e&Pt)return!0;if(e&on){var n=t.deps,r=(e&$e)!==0;if(n!==null){var i,o,a=(e&vr)!==0,u=r&&ae!==null&&!Wt,l=n.length;if(a||u){var c=t,d=c.parent;for(i=0;i<l;i++)o=n[i],(a||!o?.reactions?.includes(c))&&(o.reactions??=[]).push(c);a&&(c.f^=vr),u&&d!==null&&!(d.f&$e)&&(c.f^=$e)}for(i=0;i<l;i++)if(o=n[i],Kn(o)&&Hs(o),o.wv>t.wv)return!0}(!r||ae!==null&&!Wt)&&dt(t,He)}return!1}function ul(t,e){for(var n=e;n!==null;){if(n.f&pr)try{n.fn(t);return}catch{n.f^=pr}n=n.parent}throw sr=!1,t}function cl(t){return(t.f&kr)===0&&(t.parent===null||(t.parent.f&pr)===0)}function Ir(t,e,n,r){if(sr){if(n===null&&(sr=!1),cl(e))throw t;return}n!==null&&(sr=!0);{ul(t,e);return}}function Js(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];o.f&ft?Js(o,e,!1):e===o&&(n?dt(o,Pt):o.f&He&&dt(o,on),Vr(o))}}function $s(t){var e=qe,n=je,r=St,i=fe,o=Wt,a=wt,u=ce,l=pt,c=t.f;qe=null,je=0,St=null,fe=c&(Ot|Sn)?null:t,Wt=(c&$e)!==0&&(!pn||i===null||l),wt=null,Ki(t.ctx),pt=!1,yr++;try{var d=(0,t.fn)(),h=t.deps;if(qe!==null){var f;if(wr(t,je),h!==null&&je>0)for(h.length=je+qe.length,f=0;f<qe.length;f++)h[je+f]=qe[f];else t.deps=h=qe;if(!Wt)for(f=je;f<h.length;f++)(h[f].reactions??=[]).push(t)}else h!==null&&je<h.length&&(wr(t,je),h.length=je);if(In()&&St!==null&&!pt&&h!==null&&!(t.f&(ft|on|Pt)))for(f=0;f<St.length;f++)Js(St[f],t);return i!==null&&yr++,d}finally{qe=e,je=n,St=r,fe=i,Wt=o,wt=a,Ki(u),pt=l}}function fl(t,e){let n=e.reactions;if(n!==null){var r=_a.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&e.f&ft&&(qe===null||!qe.includes(e))&&(dt(e,on),e.f&($e|vr)||(e.f^=vr),qs(e),wr(e,0))}function wr(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)fl(t,n[r])}function fi(t){var e=t.f;if(!(e&kr)){dt(t,He);var n=ae,r=ce;ae=t;try{e&Tr?bl(t):ao(t),oo(t);var i=$s(t);t.teardown=typeof i=="function"?i:null,t.wv=Ks;var o=t.deps,a;Ur&&Wa&&t.f&Pt}catch(u){Ir(u,t,n,r||t.ctx)}finally{ae=n}}}function eo(){if(vn>1e3){vn=0;try{Oa()}catch(t){if(Yn!==null)Ir(t,Yn,null);else throw t}}vn++}function to(t){var e=t.length;if(e!==0){eo();var n=pn;pn=!0;try{for(var r=0;r<e;r++){var i=t[r];i.f&He||(i.f^=He);var o=ml(i);dl(o)}}finally{pn=n}}}function dl(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];if(!(r.f&(kr|Nt)))try{Kn(r)&&(fi(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?lo(r):r.fn=null))}catch(i){Ir(i,r,null,r.ctx)}}}function hl(){if(zn=!1,vn>1001)return;const t=en;en=[],to(t),zn||(vn=0,Yn=null)}function Vr(t){or===Qs&&(zn||(zn=!0,queueMicrotask(hl))),Yn=t;for(var e=t;e.parent!==null;){e=e.parent;var n=e.f;if(n&(Sn|Ot)){if(!(n&He))return;e.f^=He}}en.push(e)}function ml(t){var e=[],n=t.first;e:for(;n!==null;){var r=n.f,i=(r&Ot)!==0,o=i&&(r&He)!==0,a=n.next;if(!o&&!(r&Nt)){if(r&Os)e.push(n);else if(i)n.f^=He;else{var u=fe;try{fe=n,Kn(n)&&fi(n)}catch(d){Ir(d,n,null,n.ctx)}finally{fe=u}}var l=n.first;if(l!==null){n=l;continue}}if(a===null){let d=n.parent;for(;d!==null;){if(t===d)break e;var c=d.next;if(c!==null){n=c;continue e}d=d.parent}}n=a}return e}function no(t){var e=or,n=en;try{eo();const i=[];or=ol,en=i,zn=!1,to(n);var r=t?.();return Ma(),(en.length>0||i.length>0)&&no(),vn=0,Yn=null,r}finally{or=e,en=n}}async function ns(){await Promise.resolve(),no()}function s(t){var e=t.f,n=(e&ft)!==0;if(fe!==null&&!pt){wt!==null&&wt.includes(t)&&Aa();var r=fe.deps;t.rv<yr&&(t.rv=yr,qe===null&&r!==null&&r[je]===t?je++:qe===null?qe=[t]:(!Wt||!qe.includes(t))&&qe.push(t))}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&!(o.f&$e)&&(i.f^=$e)}return n&&(i=t,Kn(i)&&Hs(i)),t.v}function ve(t){var e=pt;try{return pt=!0,t()}finally{pt=e}}const pl=-7169;function dt(t,e){t.f=t.f&pl|e}function vl(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(yt in t)Gr(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&yt in n&&Gr(n)}}}function Gr(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Gr(t[r],e)}catch{}const n=si(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Es(n);for(let i in r){const o=r[i].get;if(o)try{o.call(t)}catch{}}}}}function ro(t){ae===null&&fe===null&&Ea(),fe!==null&&fe.f&$e&&ae===null&&Na(),ci&&Va()}function gl(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function an(t,e,n,r=!0){var i=(t&Sn)!==0,o=ae,a={ctx:ce,deps:null,nodes_start:null,nodes_end:null,f:t|Pt,first:null,fn:e,last:null,next:null,parent:i?null:o,prev:null,teardown:null,transitions:null,wv:0};if(n){var u=pn;try{es(!0),fi(a),a.f|=Fs}catch(d){throw xt(a),d}finally{es(u)}}else e!==null&&Vr(a);var l=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(Ds|pr))===0;if(!l&&!i&&r&&(o!==null&&gl(a,o),fe!==null&&fe.f&ft)){var c=fe;(c.effects??=[]).push(a)}return a}function io(t){const e=an(Pr,null,!1);return dt(e,He),e.teardown=t,e}function Oe(t){ro();var e=ae!==null&&(ae.f&Ot)!==0&&ce!==null&&!ce.m;if(e){var n=ce;(n.e??=[]).push({fn:t,effect:ae,reaction:fe})}else{var r=Xt(t);return r}}function yl(t){return ro(),Zn(t)}function so(t){const e=an(Sn,t,!0);return()=>{xt(e)}}function wl(t){const e=an(Sn,t,!0);return(n={})=>new Promise(r=>{n.outro?Bn(e,()=>{xt(e),r(void 0)}):(xt(e),r(void 0))})}function Xt(t){return an(Os,t,!1)}function Zn(t){return an(Pr,t,!0)}function te(t,e=[],n=M){const r=e.map(n);return Jn(()=>t(...r.map(s)))}function Jn(t,e=0){return an(Pr|Tr|e,t,!0)}function nn(t,e=!0){return an(Pr|Ot,t,!0,e)}function oo(t){var e=t.teardown;if(e!==null){const n=ci,r=fe;ts(!0),bt(null);try{e.call(null)}finally{ts(n),bt(r)}}}function ao(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;xt(n,e),n=r}}function bl(t){for(var e=t.first;e!==null;){var n=e.next;e.f&Ot||xt(e),e=n}}function xt(t,e=!0){var n=!1;if((e||t.f&Ca)&&t.nodes_start!==null){for(var r=t.nodes_start,i=t.nodes_end;r!==null;){var o=r===i?null:Mr(r);r.remove(),r=o}n=!0}ao(t,e&&!n),wr(t,0),dt(t,kr);var a=t.transitions;if(a!==null)for(const l of a)l.stop();oo(t);var u=t.parent;u!==null&&u.first!==null&&lo(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function lo(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Bn(t,e){var n=[];di(t,n,!0),uo(n,()=>{xt(t),e&&e()})}function uo(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function di(t,e,n){if(!(t.f&Nt)){if(t.f^=Nt,t.transitions!==null)for(const a of t.transitions)(a.is_global||n)&&e.push(a);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&jn)!==0||(r.f&Ot)!==0;di(r,e,o?n:!1),r=i}}}function br(t){co(t,!0)}function co(t,e){if(t.f&Nt){t.f^=Nt,t.f&He||(t.f^=He),Kn(t)&&(dt(t,Pt),Vr(t));for(var n=t.first;n!==null;){var r=n.next,i=(n.f&jn)!==0||(n.f&Ot)!==0;co(n,i?e:!1),n=r}if(t.transitions!==null)for(const o of t.transitions)(o.is_global||e)&&o.in()}}function _l(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const xl=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Pl(t){return xl.includes(t)}const Tl={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function kl(t){return t=t.toLowerCase(),Tl[t]??t}const Cl=["touchstart","touchmove"];function Sl(t){return Cl.includes(t)}function Ml(t,e){if(e){const n=document.body;t.autofocus=!0,Gn(()=>{document.activeElement===n&&t.focus()})}}let rs=!1;function Il(){rs||(rs=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function hi(t){var e=fe,n=ae;bt(null),_t(null);try{return t()}finally{bt(e),_t(n)}}function mi(t,e,n,r=n){t.addEventListener(e,()=>hi(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),Il()}const fo=new Set,Qr=new Set;function pi(t,e,n,r={}){function i(o){if(r.capture||On.call(e,o),!o.cancelBubble)return hi(()=>n?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Gn(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function is(t,e,n,r={}){var i=pi(e,t,n,r);return()=>{t.removeEventListener(e,i,r)}}function Bt(t,e,n,r,i){var o={capture:r,passive:i},a=pi(t,e,n,o);(e===document.body||e===window||e===document)&&io(()=>{e.removeEventListener(t,a,o)})}function ln(t){for(var e=0;e<t.length;e++)fo.add(t[e]);for(var n of Qr)n(t)}function On(t){var e=this,n=e.ownerDocument,r=t.type,i=t.composedPath?.()||[],o=i[0]||t.target,a=0,u=t.__root;if(u){var l=i.indexOf(u);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;l<=c&&(a=l)}if(o=i[a]||t.target,o!==e){Ns(t,"currentTarget",{configurable:!0,get(){return o||n}});var d=fe,h=ae;bt(null),_t(null);try{for(var f,p=[];o!==null;){var v=o.assignedSlot||o.parentNode||o.host||null;try{var g=o["__"+r];if(g!==void 0&&(!o.disabled||t.target===o))if(Cn(g)){var[b,...w]=g;b.apply(o,[t,...w])}else g.call(o,t)}catch(x){f?p.push(x):f=x}if(t.cancelBubble||v===e||v===null)break;o=v}if(f){for(let x of p)queueMicrotask(()=>{throw x});throw f}}finally{t.__root=e,delete t.currentTarget,bt(d),_t(h)}}}function ho(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function qn(t,e){var n=ae;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function R(t,e){var n=(e&Qa)!==0,r=(e&Ka)!==0,i,o=!t.startsWith("<!>");return()=>{i===void 0&&(i=ho(o?t:"<!>"+t),n||(i=xn(i)));var a=r||Xs?document.importNode(i,!0):i.cloneNode(!0);if(n){var u=xn(a),l=a.lastChild;qn(u,l)}else qn(a,a);return a}}function Vl(t,e,n="svg"){var r=!t.startsWith("<!>"),i=`<${n}>${r?t:"<!>"+t}</${n}>`,o;return()=>{if(!o){var a=ho(i),u=xn(a);o=xn(u)}var l=o.cloneNode(!0);return qn(l,l),l}}function vi(t=""){{var e=Sr(t+"");return qn(e,e),e}}function ze(){var t=document.createDocumentFragment(),e=document.createComment(""),n=Sr();return t.append(e,n),qn(e,n),t}function E(t,e){t!==null&&t.before(e)}let Kr=!0;function Et(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function tn(t,e){return Nl(t,e)}const cn=new Map;function Nl(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:a=!0}){il();var u=new Set,l=h=>{for(var f=0;f<h.length;f++){var p=h[f];if(!u.has(p)){u.add(p);var v=Sl(p);e.addEventListener(p,On,{passive:v});var g=cn.get(p);g===void 0?(document.addEventListener(p,On,{passive:v}),cn.set(p,1)):cn.set(p,g+1)}}};l(ii(fo)),Qr.add(l);var c=void 0,d=wl(()=>{var h=n??e.appendChild(Sr());return nn(()=>{if(o){ne({});var f=ce;f.c=o}i&&(r.$$events=i),Kr=a,c=t(h,r)||{},Kr=!0,o&&re()}),()=>{for(var f of u){e.removeEventListener(f,On);var p=cn.get(f);--p===0?(document.removeEventListener(f,On),cn.delete(f)):cn.set(f,p)}Qr.delete(l),h!==n&&h.parentNode?.removeChild(h)}});return Zr.set(c,d),c}let Zr=new WeakMap;function gi(t,e){const n=Zr.get(t);return n?(Zr.delete(t),n(e)):Promise.resolve()}function xe(t,e,n=!1){var r=t,i=null,o=null,a=Ye,u=n?jn:0,l=!1;const c=(h,f=!0)=>{l=!0,d(f,h)},d=(h,f)=>{a!==(a=h)&&(a?(i?br(i):f&&(i=nn(()=>f(r))),o&&Bn(o,()=>{o=null})):(o?br(o):f&&(o=nn(()=>f(r))),i&&Bn(i,()=>{i=null})))};Jn(()=>{l=!1,e(c),l||d(null,null)},u)}function El(t,e,n){var r=t,i=Ye,o,a=In()?Ia:Cr;Jn(()=>{a(i,i=e())&&(o&&Bn(o),o=nn(()=>n(r)))})}function Ht(t,e){return e}function Ol(t,e,n,r){for(var i=[],o=e.length,a=0;a<o;a++)di(e[a].e,i,!0);var u=o>0&&i.length===0&&n!==null;if(u){var l=n.parentNode;sl(l),l.append(n),r.clear(),Lt(t,e[0].prev,e[o-1].next)}uo(i,()=>{for(var c=0;c<o;c++){var d=e[c];u||(r.delete(d.k),Lt(t,d.prev,d.next)),xt(d.e,!u)}})}function Ut(t,e,n,r,i,o=null){var a=t,u={flags:e,items:new Map,first:null},l=(e&Ws)!==0;if(l){var c=t;a=c.appendChild(Sr())}var d=null,h=!1,f=_n(()=>{var p=n();return Cn(p)?p:p==null?[]:ii(p)});Jn(()=>{var p=s(f),v=p.length;h&&v===0||(h=v===0,Fl(p,u,a,i,e,r,n),o!==null&&(v===0?d?br(d):d=nn(()=>o(a)):d!==null&&Bn(d,()=>{d=null})),s(f))})}function Fl(t,e,n,r,i,o,a){var u=(i&Ya)!==0,l=(i&(ai|li))!==0,c=t.length,d=e.items,h=e.first,f=h,p,v=null,g,b=[],w=[],x,I,P,_;if(u)for(_=0;_<c;_+=1)x=t[_],I=o(x,_),P=d.get(I),P!==void 0&&(P.a?.measure(),(g??=new Set).add(P));for(_=0;_<c;_+=1){if(x=t[_],I=o(x,_),P=d.get(I),P===void 0){var D=f?f.e.nodes_start:n;v=Ll(D,e,v,v===null?e.first:v.next,x,I,_,r,i,a),d.set(I,v),b=[],w=[],f=v.next;continue}if(l&&Dl(P,x,_,i),P.e.f&Nt&&(br(P.e),u&&(P.a?.unfix(),(g??=new Set).delete(P))),P!==f){if(p!==void 0&&p.has(P)){if(b.length<w.length){var q=w[0],B;v=q.prev;var le=b[0],X=b[b.length-1];for(B=0;B<b.length;B+=1)ss(b[B],q,n);for(B=0;B<w.length;B+=1)p.delete(w[B]);Lt(e,le.prev,X.next),Lt(e,v,le),Lt(e,X,q),f=q,v=X,_-=1,b=[],w=[]}else p.delete(P),ss(P,f,n),Lt(e,P.prev,P.next),Lt(e,P,v===null?e.first:v.next),Lt(e,v,P),v=P;continue}for(b=[],w=[];f!==null&&f.k!==I;)f.e.f&Nt||(p??=new Set).add(f),w.push(f),f=f.next;if(f===null)continue;P=f}b.push(P),v=P,f=P.next}if(f!==null||p!==void 0){for(var H=p===void 0?[]:ii(p);f!==null;)f.e.f&Nt||H.push(f),f=f.next;var ue=H.length;if(ue>0){var we=i&Ws&&c===0?n:null;if(u){for(_=0;_<ue;_+=1)H[_].a?.measure();for(_=0;_<ue;_+=1)H[_].a?.fix()}Ol(e,H,we,d)}}u&&Gn(()=>{if(g!==void 0)for(P of g)P.a?.apply()}),ae.first=e.first&&e.first.e,ae.last=v&&v.e}function Dl(t,e,n,r){r&ai&&jr(t.v,e),r&li?jr(t.i,n):t.i=n}function Ll(t,e,n,r,i,o,a,u,l,c){var d=(l&ai)!==0,h=(l&Ba)===0,f=d?h?ui(i):Ge(i):i,p=l&li?Ge(a):a,v={i:p,v:f,k:o,a:null,e:null,prev:n,next:r};try{return v.e=nn(()=>u(t,f,p,c),Us),v.e.prev=n&&n.e,v.e.next=r&&r.e,n===null?e.first=v:(n.next=v,n.e.next=v.e),r!==null&&(r.prev=v,r.e.prev=v.e),v}finally{}}function ss(t,e,n){for(var r=t.next?t.next.e.nodes_start:n,i=e?e.e.nodes_start:n,o=t.e.nodes_start;o!==r;){var a=Mr(o);i.before(o),o=a}}function Lt(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function tt(t,e,...n){var r=t,i=ge,o;Jn(()=>{i!==(i=e())&&(o&&(xt(o),o=null),o=nn(()=>i(r,...n)))},jn)}function mo(t,e,n){Xt(()=>{var r=ve(()=>e(t,n?.())||{});if(n&&r?.update){var i=!1,o={};Zn(()=>{var a=n();vl(a),i&&Cr(o,a)&&(o=a,r.update(a))}),i=!0}if(r?.destroy)return()=>r.destroy()})}function po(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=po(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Al(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=po(t))&&(r&&(r+=" "),r+=e);return r}function At(t){return typeof t=="object"?Al(t):t??""}function vo(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function J(t,e,n,r){var i=t.__attributes??={};i[e]!==(i[e]=n)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[Sa]=n),n==null?t.removeAttribute(e):typeof n!="string"&&go(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function Nr(t,e,n,r,i=!1,o=!1,a=!1){var u=e||{},l=t.tagName==="OPTION";for(var c in e)c in n||(n[c]=null);n.class&&(n.class=At(n.class)),r!==void 0&&(n.class=n.class?n.class+" "+r:r);var d=go(t),h=t.__attributes??={};for(const w in n){let x=n[w];if(l&&w==="value"&&x==null){t.value=t.__value="",u[w]=x;continue}var f=u[w];if(x!==f){u[w]=x;var p=w[0]+w[1];if(p!=="$$"){if(p==="on"){const I={},P="$$"+w;let _=w.slice(2);var v=Pl(_);if(_l(_)&&(_=_.slice(0,-7),I.capture=!0),!v&&f){if(x!=null)continue;t.removeEventListener(_,u[P],I),u[P]=null}if(x!=null)if(v)t[`__${_}`]=x,ln([_]);else{let D=function(q){u[w].call(this,q)};u[P]=pi(_,t,D,I)}else v&&(t[`__${_}`]=void 0)}else if(w==="style"&&x!=null)t.style.cssText=x+"";else if(w==="autofocus")Ml(t,!!x);else if(!o&&(w==="__value"||w==="value"&&x!=null))t.value=t.__value=x;else if(w==="selected"&&l)vo(t,x);else{var g=w;i||(g=kl(g));var b=g==="defaultValue"||g==="defaultChecked";if(x==null&&!o&&!b)if(h[w]=null,g==="value"||g==="checked"){let I=t;const P=e===void 0;if(g==="value"){let _=I.defaultValue;I.removeAttribute(g),I.defaultValue=_,I.value=I.__value=P?_:null}else{let _=I.defaultChecked;I.removeAttribute(g),I.defaultChecked=_,I.checked=P?_:!1}}else t.removeAttribute(w);else b||d.includes(g)&&(o||typeof x!="string")?t[g]=x:typeof x!="function"&&J(t,g,x)}w==="style"&&"__styles"in t&&(t.__styles={})}}}return u}var os=new Map;function go(t){var e=os.get(t.nodeName);if(e)return e;os.set(t.nodeName,e=[]);for(var n,r=t,i=Element.prototype;i!==r;){n=Es(r);for(var o in n)n[o].set&&e.push(o);r=si(r)}return e}function lt(t,e,n){var r=t.__className,i=Rl(e,n);(r!==i||Us)&&(e==null&&!n?t.removeAttribute("class"):t.className=i,t.__className=i)}function Rl(t,e){return(t??"")+(e?" "+e:"")}function Ft(t,e,n){if(n){if(t.classList.contains(e))return;t.classList.add(e)}else{if(!t.classList.contains(e))return;t.classList.remove(e)}}function Ce(t,e,n,r){var i=t.__styles??={};i[e]!==n&&(i[e]=n,n==null?t.style.removeProperty(e):t.style.setProperty(e,n,""))}const Wl=()=>performance.now(),Vt={tick:t=>requestAnimationFrame(t),now:()=>Wl(),tasks:new Set};function yo(){const t=Vt.now();Vt.tasks.forEach(e=>{e.c(t)||(Vt.tasks.delete(e),e.f())}),Vt.tasks.size!==0&&Vt.tick(yo)}function zl(t){let e;return Vt.tasks.size===0&&Vt.tick(yo),{promise:new Promise(n=>{Vt.tasks.add(e={c:t,f:n})}),abort(){Vt.tasks.delete(e)}}}function ir(t,e){hi(()=>{t.dispatchEvent(new CustomEvent(e))})}function Yl(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function as(t){const e={},n=t.split(";");for(const r of n){const[i,o]=r.split(":");if(!i||o===void 0)break;const a=Yl(i.trim());e[a]=o.trim()}return e}const Bl=t=>t;function wo(t,e,n,r){var i=(t&Ga)!==0,o="both",a,u=e.inert,l=e.style.overflow,c,d;function h(){var b=fe,w=ae;bt(null),_t(null);try{return a??=n()(e,r?.()??{},{direction:o})}finally{bt(b),_t(w)}}var f={is_global:i,in(){e.inert=u,ir(e,"introstart"),c=Jr(e,h(),d,1,()=>{ir(e,"introend"),c?.abort(),c=a=void 0,e.style.overflow=l})},out(b){e.inert=!0,ir(e,"outrostart"),d=Jr(e,h(),c,0,()=>{ir(e,"outroend"),b?.()})},stop:()=>{c?.abort(),d?.abort()}},p=ae;if((p.transitions??=[]).push(f),Kr){var v=i;if(!v){for(var g=p.parent;g&&g.f&jn;)for(;(g=g.parent)&&!(g.f&Tr););v=!g||(g.f&Fs)!==0}v&&Xt(()=>{ve(()=>f.in())})}}function Jr(t,e,n,r,i){var o=r===1;if(dn(e)){var a,u=!1;return Gn(()=>{if(!u){var b=e({direction:o?"in":"out"});a=Jr(t,b,n,r,i)}}),{abort:()=>{u=!0,a?.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(n?.deactivate(),!e?.duration)return i(),{abort:ge,deactivate:ge,reset:ge,t:()=>r};const{delay:l=0,css:c,tick:d,easing:h=Bl}=e;var f=[];if(o&&n===void 0&&(d&&d(0,1),c)){var p=as(c(0,1));f.push(p,p)}var v=()=>1-r,g=t.animate(f,{duration:l});return g.onfinish=()=>{var b=n?.t()??1-r;n?.abort();var w=r-b,x=e.duration*Math.abs(w),I=[];if(x>0){var P=!1;if(c)for(var _=Math.ceil(x/16.666666666666668),D=0;D<=_;D+=1){var q=b+w*h(D/_),B=as(c(q,1-q));I.push(B),P||=B.overflow==="hidden"}P&&(t.style.overflow="hidden"),v=()=>{var le=g.currentTime;return b+w*h(le/x)},d&&zl(()=>{if(g.playState!=="running")return!1;var le=v();return d(le,1-le),!0})}g=t.animate(I,{duration:x,fill:"forwards"}),g.onfinish=()=>{v=()=>r,d?.(r,1-r),i()}},{abort:()=>{g&&(g.cancel(),g.effect=null,g.onfinish=ge)},deactivate:()=>{i=ge},reset:()=>{r===0&&d?.(1,0)},t:()=>v()}}function yi(t,e,n=e){var r=In();mi(t,"input",i=>{var o=i?t.defaultValue:t.value;if(o=Rr(t)?Wr(o):o,n(o),r&&o!==(o=e())){var a=t.selectionStart,u=t.selectionEnd;t.value=o??"",u!==null&&(t.selectionStart=a,t.selectionEnd=Math.min(u,t.value.length))}}),ve(e)==null&&t.value&&n(Rr(t)?Wr(t.value):t.value),Zn(()=>{var i=e();Rr(t)&&i===Wr(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function ql(t,e,n=e){mi(t,"change",r=>{var i=r?t.defaultChecked:t.checked;n(i)}),ve(e)==null&&n(t.checked),Zn(()=>{var r=e();t.checked=!!r})}function Rr(t){var e=t.type;return e==="number"||e==="range"}function Wr(t){return t===""?null:+t}function _r(t,e,n){if(t.multiple)return Ul(t,e);for(var r of t.options){var i=Ln(r);if(rl(i,e)){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function bo(t,e){let n=!0;Xt(()=>{e&&_r(t,ve(e),n),n=!1;var r=new MutationObserver(()=>{var i=t.__value;_r(t,i)});return r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Hl(t,e,n=e){var r=!0;mi(t,"change",i=>{var o=i?"[selected]":":checked",a;if(t.multiple)a=[].map.call(t.querySelectorAll(o),Ln);else{var u=t.querySelector(o)??t.querySelector("option:not([disabled])");a=u&&Ln(u)}n(a)}),Xt(()=>{var i=e();if(_r(t,i,r),r&&i===void 0){var o=t.querySelector(":checked");o!==null&&(i=Ln(o),n(i))}t.__value=i,r=!1}),bo(t)}function Ul(t,e){for(var n of t.options)n.selected=~e.indexOf(Ln(n))}function Ln(t){return"__value"in t?t.__value:t.value}class wi{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,n){var r=this.#e.get(e)||new Set;return r.add(n),this.#e.set(e,r),this.#r().observe(e,this.#n),()=>{var i=this.#e.get(e);i.delete(n),i.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#r(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var n of e){wi.entries.set(n.target,n);for(var r of this.#e.get(n.target)||[])r(n)}}))}}var Xl=new wi({box:"border-box"});function vt(t,e,n){var r=Xl.observe(t,()=>n(t[e]));Xt(()=>(ve(()=>n(t[e])),r))}function ls(t,e){return t===e||t?.[yt]===e}function De(t={},e,n,r){return Xt(()=>{var i,o;return Zn(()=>{i=o,o=[],ve(()=>{t!==n(...o)&&(e(t,...o),i&&ls(n(...i),t)&&e(null,...i))})}),()=>{Gn(()=>{o&&ls(n(...o),t)&&e(null,...o)})}}),t}function jl(t){return function(...e){var n=e[0];return n.stopPropagation(),t?.apply(this,e)}}function Gl(t){return function(...e){var n=e[0];return n.preventDefault(),t?.apply(this,e)}}function Ql(t,e){var n=t.$$events?.[e.type],r=Cn(n)?n.slice():n==null?[]:[n];for(var i of r)i.call(this,e)}let Fn=!1,$r=Symbol();function Mt(t,e,n){const r=n[e]??={store:null,source:ui(void 0),unsubscribe:ge};if(r.store!==t&&!($r in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=ge;else{var i=!0;r.unsubscribe=_o(t,o=>{i?r.source.v=o:y(r.source,o)}),i=!1}return t&&$r in n?It(t):s(r.source)}function Rt(t,e){return t.set(e),e}function Er(){const t={};function e(){io(()=>{for(var n in t)t[n].unsubscribe();Ns(t,$r,{enumerable:!1,value:!0})})}return[t,e]}function bi(){Fn=!0}function Kl(t){var e=Fn;try{return Fn=!1,[t(),Fn]}finally{Fn=e}}const Zl={get(t,e){if(!t.exclude.includes(e))return t.props[e]},set(t,e){return!1},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function $n(t,e,n){return new Proxy({props:t,exclude:e},Zl)}const Jl={get(t,e){let n=t.props.length;for(;n--;){let r=t.props[n];if(dn(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(t,e,n){let r=t.props.length;for(;r--;){let i=t.props[r];dn(i)&&(i=i());const o=Yt(i,e);if(o&&o.set)return o.set(n),!0}return!1},getOwnPropertyDescriptor(t,e){let n=t.props.length;for(;n--;){let r=t.props[n];if(dn(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const i=Yt(r,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(t,e){if(e===yt||e===Ls)return!1;for(let n of t.props)if(dn(n)&&(n=n()),n!=null&&e in n)return!0;return!1},ownKeys(t){const e=[];for(let n of t.props){dn(n)&&(n=n());for(const r in n)e.includes(r)||e.push(r)}return e}};function $l(...t){return new Proxy({props:t},Jl)}function U(t,e,n,r){var i=(n&qa)!==0,o=!Mn||(n&Ha)!==0,a=(n&Xa)!==0,u=(n&ja)!==0,l=!1,c;a?[c,l]=Kl(()=>t[e]):c=t[e];var d=yt in t||Ls in t,h=a&&(Yt(t,e)?.set??(d&&e in t&&(D=>t[e]=D)))||void 0,f=r,p=!0,v=!1,g=()=>(v=!0,p&&(p=!1,u?f=ve(r):f=r),f);c===void 0&&r!==void 0&&(h&&o&&Fa(),c=g(),h&&h(c));var b;if(o)b=()=>{var D=t[e];return D===void 0?g():(p=!0,v=!1,D)};else{var w=(i?M:_n)(()=>t[e]);w.f|=ka,b=()=>{var D=s(w);return D!==void 0&&(f=void 0),D===void 0?f:D}}if(!(n&Ua))return b;if(h){var x=t.$$legacy;return function(D,q){return arguments.length>0?((!o||!q||x||l)&&h(q?b():D),D):b()}}var I=!1,P=ui(c),_=M(()=>{var D=b(),q=s(P);return I?(I=!1,q):P.v=D});return i||(_.equals=oi),function(D,q){if(arguments.length>0){const B=q?s(_):o&&a?C(D):D;return _.equals(B)||(I=!0,y(P,B),v&&f!==void 0&&(f=B),ve(()=>s(_))),D}return s(_)}}function Hn(t){yl(()=>{t();var e=ae;e.f&Pt&&(Za(),dt(e,on))})}function eu(){const t=ce;return t===null&&Qn(),e=>n=>{const r=t.s.$$events?.[e];if(r){const i=Cn(r)?r.slice():[r];for(const o of i)o.call(t.x,n);return!n.defaultPrevented}return!0}}function rn(t){ce===null&&Qn(),Mn&&ce.l!==null?ru(ce).m.push(t):Oe(()=>{const e=ve(t);if(typeof e=="function")return e})}function tu(t){ce===null&&Qn(),rn(()=>()=>ve(t))}function nu(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}function jt(){const t=ce;return t===null&&Qn(),(e,n,r)=>{const i=t.s.$$events?.[e];if(i){const o=Cn(i)?i.slice():[i],a=nu(e,n,r);for(const u of o)u.call(t.x,a);return!a.defaultPrevented}return!0}}function ru(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}function _o(t,e,n){if(t==null)return e(void 0),ge;const r=ve(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const fn=[];function xr(t,e=ge){let n=null;const r=new Set;function i(u){if(Cr(t,u)&&(t=u,n)){const l=!fn.length;for(const c of r)c[1](),fn.push(c,t);if(l){for(let c=0;c<fn.length;c+=2)fn[c][0](fn[c+1]);fn.length=0}}}function o(u){i(u(t))}function a(u,l=ge){const c=[u,l];return r.add(c),r.size===1&&(n=e(i,o)||ge),u(t),()=>{r.delete(c),r.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}function It(t){let e;return _o(t,n=>e=n)(),e}function iu(t){if(t.titleEl)return t.titleEl}function su(t){return"updateHeader"in t&&typeof t.updateHeader=="function"&&t.updateHeader!=null?t:null}function xo(t,e){const n=new Map,r=new Map;return{make(i,o){let a=n.get(String(i));return a||(i in t?a=xr(t[i]):a=xr(o),a.subscribe(u=>{t[i]!==u&&(t[i]=u,e(i,u))}),n.set(String(i),a),a)},namespace(i){let o=r.get(String(i));if(o)return o;const a=t[i]||{};return o=xo(a,(u,l)=>{a[u]=l,t[i]=a,e(i,a)}),r.set(String(i),o),o}}}const ou="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(ou);class mt{constructor(e){this.valuePerPixel=e}toPixels(e){return Math.floor(e/this.valuePerPixel)}toValue(e){return e*this.valuePerPixel}}function au(t,e){const n=lu(t),i=uu(t)-n,o=e.padding.start+e.items.margin.start+e.items.size/2,a=e.padding.end+e.items.margin.end+e.items.size/2,u=e.size-o-a,l=a-o,c=i===0?new mt(1):new mt(i/u),d=i===0?n:n+i/2,h=c.toValue(l/2);return[c,d+h]}function lu(t){let e=Number.POSITIVE_INFINITY;for(const n of t){const r=n.startValue();r<e&&(e=r)}return e===Number.POSITIVE_INFINITY?0:e}function uu(t){let e=Number.NEGATIVE_INFINITY;for(const n of t){let r=n.startValue()+n.length();r>e&&(e=r)}return e===Number.NEGATIVE_INFINITY?0:e}class cu{constructor(e,n,r,i){this.scaleProperty=e,this.items=n,this.setFocalValue=r,this.fitBounds=i,this.scale=new mt(1),e.subscribe(o=>{this.scale=o})}scale;zoomIn(e){const n=this.scale.toValue(1);let r=Math.floor(Math.log10(n));const i=Math.pow(10,r);let o=Math.floor(n/i);o-=1,o===0&&(o=9,r-=1);const a=this.scaleProperty.set(new mt(o*Math.pow(10,r)));if(e!=null){const{keepValue:u,at:l}=e;this.setFocalValue(()=>u-a.toValue(l))}}zoomOut(e){const n=this.scale.toValue(1);let r=Math.floor(Math.log10(n));const i=Math.pow(10,r);let o=Math.floor(n/i);o+=1,o===10&&(o=1,r+=1);const a=this.scaleProperty.set(new mt(o*Math.pow(10,r)));if(e!=null){const{keepValue:u,at:l}=e;this.setFocalValue(()=>u-a.toValue(l))}}zoomToFit(e=this.items.get(),n=this.fitBounds()){const[r,i]=au(e,n);this.scaleProperty.set(r),this.setFocalValue(()=>i)}scrollToFirst(){const e=this.minimumValue();this.scrollToValue(e)}scrollToValue(e){this.setFocalValue(()=>e)}minimumValue(e=this.items.get()){let n;for(const r of e){const i=r.startValue();(n===void 0||i<n)&&(n=i)}return n===void 0&&(n=0),n}maximumValue(e=this.items.get()){let n;for(const r of e){const i=r.startValue();(n===void 0||i>n)&&(n=i)}return n===void 0&&(n=0),n}centerValue(e=this.items.get()){const n=this.minimumValue(e);return(this.maximumValue(e)-n)/2+n}}function fu(t,e,n,r){return new cu(t,e,n,r)}var Pn=(t=>(t[t.Numeric=0]="Numeric",t[t.Date=1]="Date",t))(Pn||{});function us(t,e,n,r){switch(t){case 0:return Po(e,n,r?.disallowMultiples);case 1:return hu(e,n,r?.disallowMultiples)}}function Po(t,e,n=!1){const r=e.toValue(t),i=Math.floor(Math.log10(r)),o=Math.pow(10,i);if(o>=r)return o;if(n)return o*10;let a=o*2.5;return a>=r&&Math.trunc(a)===a||(a=o*5,a>=r)?a:o*10}const du=1,We=1e3*du,Ae=60*We,Re=60*Ae,_e=24*Re,zr=7*_e,Je=28*_e,Be=365*_e;function hu(t,e,n=!1){const r=e.toValue(t);if(We>=r)return Po(t,e);if(Ae>=r)return We>=r?We:n?Ae:2*We>=r?2*We:5*We>=r?5*We:10*We>=r?10*We:30*We>=r?30*We:Ae;if(Re>=r)return Ae>=r?Ae:n?Re:2*Ae>=r?2*Ae:5*Ae>=r?5*Ae:10*Ae>=r?10*Ae:30*Ae>=r?30*Ae:Re;if(_e>=r)return Re>=r?Re:n?_e:2*Re>=r?2*Re:3*Re>=r?3*Re:6*Re>=r?6*Re:12*Re>=r?12*Re:_e;if(zr>=r||Je>=r){if(!n){if(2*_e>=r)return 2*_e;if(3*_e>=r)return 3*_e;if(4*_e>=r)return 4*_e;if(zr>=r)return zr}return n?Je:14*_e>=r?14*_e:Je}else if(Be>=r){if(!n){if(3*Je>=r)return 3*Je;if(6*Je>=r)return 6*Je}return Be}const i=r/Be,o=Math.floor(Math.log10(i)),a=Math.pow(10,o);if(a>=i)return a*Be;if(n)return a*10*Be;let u=a*2;return u>=i||(u=a*2.5,u>=i&&Math.trunc(u)===u)||(u=a*5,u>=i)?u*Be:a*10*Be}function To(t,e){return Math.floor(e/t)*t}function mu(t,e){const n=window.moment(e);if(t<We)return To(t,e);if(t<Ae){const a=Math.floor(t/We),u=n.second(),l=u-u%a;return n.second(l).startOf("second").valueOf()}if(t<Re){const a=Math.floor(t/Ae),u=n.minute(),l=u-u%a;return n.minute(l).startOf("minute").valueOf()}if(t<_e){const a=Math.floor(t/Re),u=n.hour(),l=u-u%a;return n.hour(l).startOf("hour").valueOf()}if(t<Je){const a=Math.floor(t/_e);let l=n.startOf("month"),c=l.clone().add(a,"day");for(;c.valueOf()<e;)l=c,c=l.clone().add(a,"day");return l.valueOf()}if(t<Be){const a=Math.floor(t/Je),u=n.month(),l=u-u%a;return n.month(l).startOf("month").valueOf()}const r=Math.floor(t/Be),i=n.year(),o=i-i%r;return n.year(o).startOf("year").valueOf()}function cs(t,e,n,r){switch(t){case 0:{let i=To(e,n);const o=[i];do o.push(i),i=pu(i,e);while(i<r);return o}case 1:{let i=mu(e,n);const o=[i];do o.push(i),i=vu(i,e);while(i<r);return o}}}function pu(t,e){return t+e}function vu(t,e){if(e<=_e)return t+e;if(e<Je){const i=Math.floor(e/_e),o=window.moment(t),a=o.add(i,"day");return a.clone().add(i,"day").month()!==o.month()?a.add(1,"month").startOf("month").valueOf():a.valueOf()}if(e<Be){const i=Math.floor(e/Je);return window.moment(t).add(i,"month").valueOf()}const n=Math.floor(e/Be);return window.moment(t).add(n,"year").valueOf()}function ei(t,e,n){switch(t){case 0:return gu(n);case 1:return yu(n,e)}}function gu(t){return t.toLocaleString()}function yu(t,e){const n=new Date(t);return e<We?window.moment(t).format("MMM D, YYYY h:mm:ss.SSS a"):e<Ae?window.moment(t).format("MMM D, YYYY h:mm:ss a"):e<Re?window.moment(t).format("MMM D, YYYY h:mm a"):e<_e?window.moment(t).format("MMM D, YYYY h a"):e<Je?window.moment(t).format("MMM D, YYYY"):e<Be?window.moment(t).format("MMM YYYY"):n.getFullYear().toLocaleString()}function wu(t){return t.toLocaleString()}function bu(t,e){const n=new Date(t);let r="";const i=n.getUTCFullYear()-1970,o=n.getUTCMonth(),a=n.getUTCDate(),u=n.getUTCHours(),l=n.getUTCMinutes(),c=n.getUTCSeconds(),d=n.getUTCMilliseconds();let h=!1;return i>0&&(h=!0,r+=`${i}y `),o>0&&(e<Be||!h)&&(h=!0,r+=`${o}M `),a>0&&(e<=_e||!h)&&(h=!0,r+=`${a}d `),u>0&&(e<=_e||!h)&&(h=!0,r+=`${u}h `),l>0&&(e<=_e||!h)&&(h=!0,r+=`${l}m `),c>0&&(e<=_e||!h)&&(h=!0,r+=`${c}s `),d>0&&(e<=We||!h)&&(r+=`${d}ms`),r.trim()}var _u=R('<div class="timeline-view--ruler-label svelte-1sea4gf"> </div>');function fs(t,e){ne(e,!0);let n=U(e,"style",3,""),r=V(0);function i(){return s(r)}var o=_u(),a=Y(o);return te(u=>{J(o,"aria-hidden",e.hidden),J(o,"data-value",e.value),J(o,"data-value-text",u),J(o,"style",`--position:${e.position??""}px;${n()??""}`),Et(a,e.text)},[()=>e.displayType===Pn.Numeric?e.value.toLocaleString():window.moment(e.value).toLocaleString()]),vt(o,"offsetWidth",u=>y(r,u)),E(t,o),re({size:i})}function Ze(t,e){const n=document.createElement("div");n.className="tooltip "+e.className+" "+(e.mod||""),n.innerText=e.label;const r=document.createElement("div");r.className="tooltip-arrow",n.appendChild(r);function i({elementPosition:a=Ze.center,mod:u,styles:l}){const c=t.getBoundingClientRect(),d=a(c),h=u==="mod-left"?-r.offsetWidth:u==="mod-right"?r.offsetWidth:0,f=u==="mod-top"?-r.offsetHeight:u===void 0?r.offsetHeight:0;n.setCssStyles({...l,top:`${d.y+f}px`,left:`${d.x+h}px`})}i(e),e.visible&&document.body.appendChild(n);let o=new MutationObserver(()=>i(e));return o.observe(t,{attributes:!0}),{destroy(){o.disconnect(),n.remove()},update(a){n.innerText=a.label,r.parentElement!==n&&n.appendChild(r),n.className="tooltip "+a.className+" "+(a.mod||""),o.disconnect(),o=new MutationObserver(()=>i(a)),o.observe(t,{attributes:!0}),a.visible&&n.parentElement!=document.body?document.body.appendChild(n):!a.visible&&n.parentElement==document.body&&n.remove(),i(a)}}}Ze.center=function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}};Ze.bottom=function(t){return{x:t.x+t.width/2,y:t.bottom}};Ze.top=function(t){return{x:t.x+t.width/2,y:t.top}};Ze.left=function(t){return{x:t.left,y:t.y+t.height/2}};Ze.right=function(t){return{x:t.right,y:t.y+t.height/2}};Ze.topLeft=function(t){return{x:t.left,y:t.top}};Ze.topRight=function(t){return{x:t.right,y:t.top}};Ze.bottomLeft=function(t){return{x:t.left,y:t.bottom}};Ze.bottomRight=function(t){return{x:t.right,y:t.bottom}};function xu(t){return{x:t.left+t.width/2,y:t.top+t.height/2}}function _i(t,e){let n=V(t.getBoundingClientRect());const r=so(()=>{Oe(()=>{let a=!1;function u(){a||(y(n,t.getBoundingClientRect()),requestAnimationFrame(u))}return requestAnimationFrame(u),()=>{a=!0}});const i=M(()=>(e.side??xu)(s(n))),o=tn(Tu,{target:t.doc.body,props:{get x(){return s(i).x},get y(){return s(i).y},get mod(){return e.mod},get label(){return e.label},get class(){return e.class}}});return()=>{gi(o)}});return{destroy(){r()}}}var Pu=R('<div> <div class="tooltip-arrow"></div></div>');function Tu(t,e){ne(e,!0);let n=V(null);const r=M(()=>e.mod==="mod-left"?-(s(n)?.offsetWidth??0):e.mod==="mod-right"?s(n)?.offsetWidth??0:0),i=M(()=>e.mod==="mod-top"?-(s(n)?.offsetHeight??0):e.mod===void 0?s(n)?.offsetHeight??0:0),o=M(()=>e.x+s(r)),a=M(()=>e.y+s(i));var u=Pu(),l=Y(u),c=A(l);De(c,d=>y(n,d),()=>s(n)),te(()=>{lt(u,`tooltip ${e.mod??""} ${e.class??""}`),Ce(u,"left",`${s(o)??""}px`),Ce(u,"top",`${s(a)??""}px`),Et(l,`${e.label??""} `)}),E(t,u),re()}var ku=R('<div class="svelte-1d9cqje"></div>');function Cu(t,e){ne(e,!0);var n=ku();mo(n,(r,i)=>_i?.(r,i),()=>({get label(){return e.label},mod:"mod-top",side:Ze.top})),te(()=>J(n,"style",`left: ${e.x??""}px;`)),E(t,n),re()}var Su=R('<div class="timeline-view--ruler-notch svelte-wk6lpp"></div>');function Mu(t,e){ne(e,!0);var n=Su();te(r=>{J(n,"data-value",r),Ce(n,"--position",`${e.position??""}px`)},[()=>e.displayType===Pn.Numeric?e.value.toLocaleString():window.moment(e.value).toLocaleString()]),E(t,n),re()}var Iu=R('<div class="timeline-view--ruler svelte-1s6zwda" role="slider" tabindex="0"><!> <!> <!> <!></div>');function Vu(t,e){ne(e,!0);let n=V(0),r=U(e,"clientHeight",15,0);const i=jt();let o=V(void 0);function a(_){const D=_.clientX-_.currentTarget.getBoundingClientRect().left,q=s(n)/2-D;let B=Math.floor(e.focalValue-e.scale.toValue(q));Object.is(B,-0)&&(B=0),y(o,C({value:ei(e.displayType,e.scale.toValue(1),B),x:D})),i("mouseMeasurement",s(o))}function u(_){y(o,void 0),i("mouseMeasurement",s(o))}let l=V(void 0);const c=M(()=>s(l)?.size()??192),d=M(()=>us(e.displayType,s(c),e.scale)),h=M(()=>{const _=e.scale.toValue(s(n));return cs(e.displayType,s(d),e.focalValue-_/2,e.focalValue+_/2)}),f=M(()=>us(e.displayType,s(c)/10,e.scale,{disallowMultiples:!0})),p=M(()=>{if(s(f)===s(d))return[];const _=e.scale.toValue(s(n));return cs(e.displayType,s(f),e.focalValue-_/2,e.focalValue+_/2)});function v(){return s(d)}var g=Iu();g.__mousemove=a,J(g,"aria-valuemin",Number.NEGATIVE_INFINITY),J(g,"aria-valuemax",Number.POSITIVE_INFINITY);var b=Y(g);{var w=_=>{Cu(_,{get x(){return s(o).x},get label(){return s(o).value}})};xe(b,_=>{s(o)!=null&&_(w)})}var x=A(b,2);De(fs(x,{get displayType(){return e.displayType},value:0,text:"MMM DD, YYYY HH:mm:ss.SSS AM",position:0,style:"position:relative;",hidden:!0}),_=>y(l,C(_)),()=>s(l));var I=A(x,2);Ut(I,17,()=>s(h),Ht,(_,D)=>{const q=M(()=>ei(e.displayType,s(d),s(D))),B=M(()=>e.scale.toPixels(s(D)-e.focalValue)+s(n)/2);fs(_,{get displayType(){return e.displayType},get value(){return s(D)},get text(){return s(q)},get position(){return s(B)}})});var P=A(I,2);return Ut(P,17,()=>s(p),Ht,(_,D)=>{const q=M(()=>e.scale.toPixels(s(D)-e.focalValue)+s(n)/2);Mu(_,{get displayType(){return e.displayType},get value(){return s(D)},get position(){return s(q)}})}),te(()=>{J(g,"data-min-value-step",s(d)),J(g,"aria-valuenow",e.focalValue)}),Bt("mouseleave",g,u),vt(g,"clientWidth",_=>y(n,_)),vt(g,"clientHeight",r),E(t,g),re({minValueStep:v})}ln(["mousemove"]);function Nu(t,e,n,r,i){t.beginPath(),t.clearRect(0,0,e.width,e.height),ds(t,e,r,n),i!=null&&i.length>0&&ds(t,e,i,n)}function ds(t,e,n,r){const i=t.strokeStyle,o=t.fillStyle,a=0;let u=i,l=o,c=2;const d=r===0?h=>{t.rect(h.offsetLeft,h.offsetTop,h.offsetWidth,h.offsetHeight)}:h=>{t.roundRect(h.offsetLeft,h.offsetTop,h.offsetWidth,h.offsetHeight,r)};t.globalCompositeOperation="source-over",t.beginPath();for(let h=0;h<n.length;h++){const f=n[h];if(f.visible===!1||f.offsetTop>e.height||f.offsetBottom<0||f.offsetLeft>e.width||f.offsetRight<0)continue;const p=f.backgroundColor??o,v=f.borderColor??i,g=f.strokeWidth??a;(p!==l||v!==u||g!==c)&&(t.fill(),c>0&&t.stroke(),t.beginPath(),t.fillStyle=p,l=p,t.strokeStyle=v,u=v,t.lineWidth=g,c=g),d(f)}t.closePath(),t.fill(),c>0&&t.stroke(),t.globalCompositeOperation="destination-out",t.beginPath();for(let h=0;h<n.length;h++){const f=n[h];f.visible!==!1&&(f.offsetTop>e.height||f.offsetBottom<0||f.offsetLeft>e.width||f.offsetRight<0||f.offsetHeight!==f.offsetWidth&&t.rect(f.offsetLeft+r,f.offsetTop+(r-1),f.offsetWidth-r*2,2))}t.fill()}function Eu(t){return t.offsetTop+t.offsetHeight}function Ou(t){return t.offsetLeft+t.offsetWidth}function Yr(t,e,n){return t.offsetLeft<=e&&e<Ou(t)&&t.offsetTop<=n&&n<Eu(t)}class ar{constructor(e,n,r){this.fill=e,this.stroke=n,this.strokeWidth=r}static fromCSS(e){return new ar(e.backgroundColor,e.borderColor,parseFloat(e.borderWidth))}static unstyled=new ar("","",0);equals(e){return e instanceof ar?e.fill===this.fill&&e.stroke===this.stroke&&e.strokeWidth===this.strokeWidth:!1}}const Fu=t=>t;function Du(t){const e=t-1;return e*e*e+1}function Lu(t,{delay:e=0,duration:n=400,easing:r=Fu}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:o=>`opacity: ${o*i}`}}function Au(t,{delay:e=0,duration:n=400,easing:r=Du,axis:i="y"}={}){const o=getComputedStyle(t),a=+o.opacity,u=i==="y"?"height":"width",l=parseFloat(o[u]),c=i==="y"?["top","bottom"]:["left","right"],d=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),h=parseFloat(o[`padding${d[0]}`]),f=parseFloat(o[`padding${d[1]}`]),p=parseFloat(o[`margin${d[0]}`]),v=parseFloat(o[`margin${d[1]}`]),g=parseFloat(o[`border${d[0]}Width`]),b=parseFloat(o[`border${d[1]}Width`]);return{delay:e,duration:n,easing:r,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*a};${u}: ${w*l}px;padding-${c[0]}: ${w*h}px;padding-${c[1]}: ${w*f}px;margin-${c[0]}: ${w*p}px;margin-${c[1]}: ${w*v}px;border-${c[0]}-width: ${w*g}px;border-${c[1]}-width: ${w*b}px;min-${u}: 0`}}function ko(t,e){const n=document.body.getBoundingClientRect();let r=Math.max(0,Math.min(n.width,e.x)),i=Math.max(0,Math.min(n.height,e.y)),o=Math.max(0,Math.min(n.width,e.right)),a=Math.max(0,Math.min(n.height,e.bottom));return t(new DOMRect(r,i,o-r,a-i))}var Ru=R('<div class="timeline-view--item-hover svelte-vtppeg"></div>');function Wu(t,e){ne(e,!0);let n=V(null),r=V(null);function i(){o(),y(r,C(_i(s(n),{mod:"mod-top",label:e.summary,side:ko.bind(null,Ze.top)})))}function o(){s(r)?.destroy()}var a=Ru();De(a,u=>y(n,u),()=>s(n)),te(()=>{J(a,"aria-label",e.summary),Ce(a,"--top",`${e.position.offsetTop??""}px`),Ce(a,"--left",`${e.position.offsetLeft??""}px`),Ce(a,"--width",`${e.position.offsetWidth??""}px`)}),Bt("introend",a,i),Bt("outrostart",a,o),wo(3,a,()=>Lu,()=>({duration:500})),E(t,a),re()}var zu=R('<div class="timeline-item focus svelte-fr0gfn"></div>');function Yu(t,e){ne(e,!0);var n=zu();te(()=>{Ce(n,"--top",`${e.focus.offsetTop??""}px`),Ce(n,"--left",`${e.focus.offsetLeft??""}px`),Ce(n,"--width",`${e.focus.offsetWidth??""}px`)}),E(t,n),re()}var Bu=R('<div class="timeline-view--timeline-selection-area svelte-tomc62"></div>');function Co(t,e){ne(e,!0);var n=ze(),r=pe(n);{var i=o=>{var a=Bu();te(()=>{J(a,"role",e.role),J(a,"aria-label",e.label),Ce(a,"--left",`${e.area.offsetLeft??""}px`),Ce(a,"--top",e.area.offsetTop+"px"),Ce(a,"--width",e.area.offsetWidth+"px"),Ce(a,"--height",e.area.offsetHeight+"px")}),E(o,a)};xe(r,o=>{e.area!=null&&o(i)})}E(t,n),re()}function qu(t,e){var n=ze(),r=pe(n);{var i=o=>{Co(o,{get area(){return e.bounds},role:"region",get label(){return`${e.selectedItemCount??""} items selected`}})};xe(r,o=>{e.bounds!=null&&e.selectedItemCount>1&&o(i)})}E(t,n)}var Hu=R('<div class="svelte-1embv5v"></div>');function Uu(t,e){ne(e,!0);var n=Hu();mo(n,(r,i)=>_i?.(r,i),()=>({get label(){return e.summary},mod:"mod-top",side:ko.bind(null,Ze.top)})),te(()=>{J(n,"aria-label",e.summary),Ce(n,"top",`${e.position.offsetTop??""}px`),Ce(n,"left",`${e.position.offsetLeft??""}px`),Ce(n,"width",`${e.position.offsetWidth??""}px`)}),E(t,n),re()}class Xu{constructor(e,n,r,i,o,a,u,l){this.base=e,this.backgroundColor=a,this.borderColor=u,this.strokeWidth=l,this.value=n,this.length=r,this.endValue=i,this.offsetCenterX=o,this.offsetWidth=e.offsetWidth,this.offsetRight=e.offsetRight,this.offsetLeft=e.offsetLeft}get visible(){return!0}#e=V(0);get value(){return s(this.#e)}set value(e){y(this.#e,C(e))}#t=V(0);get length(){return s(this.#t)}set length(e){y(this.#t,C(e))}#n=V(0);get endValue(){return s(this.#n)}set endValue(e){y(this.#n,C(e))}#r=V(0);get offsetCenterX(){return s(this.#r)}set offsetCenterX(e){y(this.#r,C(e))}#i=V(0);get offsetWidth(){return s(this.#i)}set offsetWidth(e){y(this.#i,C(e))}#s=V(0);get offsetRight(){return s(this.#s)}set offsetRight(e){y(this.#s,C(e))}#o=V(0);get offsetLeft(){return s(this.#o)}set offsetLeft(e){y(this.#o,C(e))}get offsetTop(){return this.base.offsetTop}get offsetBottom(){return this.offsetTop+this.base.offsetHeight}get offsetHeight(){return this.base.offsetHeight}}function ju(t,e){e.forEach(n=>n.scale(t))}function Gu(t,e,n){const r=Math.max(e.top,e.bottom),i=Math.max(e.left,e.right),o=t/2,a=t+r;let u=[];for(let l=0;l<n.length;l++){const c=n[l],d=c.valuePx-o,h=d+c.lengthPx+t,f=d-i;let p=0;for(;p<u.length&&u[p]>=f;)p++;const v=e.top+p*a,g=v+t;u[p]=h,c.layout(v,d,g,h,t,h-d,g-v)}}class An{constructor(e){this.item=e}static#e=new WeakMap;static from(e){const n=An.#e.get(e);if(n!==void 0)return n;const r=new An(e);return An.#e.set(e,r),r}get id(){return this.item.id}name(){return this.item.name()}color(){return this.item.color()}get source(){return this.item.source}value(){return this.item.startValue()}length(){return this.item.length()}valuePx=0;lengthPx=0;scale(e){const n=this.item;this.valuePx=e.toPixels(n.startValue()),this.lengthPx=e.toPixels(n.length())}layoutTop=0;layoutLeft=0;layoutBottom=0;layoutRight=0;minSize=0;layout(e,n,r,i,o,a,u){this.layoutTop=e,this.layoutLeft=n,this.layoutBottom=r,this.layoutRight=i,this.minSize=o,this.offsetWidth=a,this.offsetHeight=u}offsetTop=0;offsetLeft=0;offsetRight=0;offsetBottom=0;offsetWidth=0;offsetHeight=0;scroll(e,n){this.offsetTop=this.layoutTop-e,this.offsetBottom=this.layoutBottom-e,this.offsetLeft=this.layoutLeft-n,this.offsetRight=this.layoutRight-n}offsetContains(e,n){return this.offsetLeft<=e&&e<this.offsetRight&&this.offsetTop<=n&&n<this.offsetBottom}offsetIntersects(e,n,r,i){return(e>=this.offsetLeft&&e<this.offsetRight||this.offsetLeft>=e&&this.offsetLeft<e+r)&&(n>=this.offsetTop&&n<this.offsetBottom||this.offsetTop>=n&&this.offsetTop<n+i)}backgroundColor="";borderColor="";strokeWidth=0;visible=!0;show(){this.visible=!0}hide(){this.visible=!1}}class Qu{#e=new Map;#t=V({value:new Set});updateItems(e){const n=ve(()=>s(this.#t)).value,r=new Set,i=[];let o=!1;for(let a=0;a<e.length;a++){const u=e[a];r.add(u.id),this.#e.get(u.id)!==a&&(o=!0,this.#e.set(u.id,a))}for(const a of n.keys())r.has(a)||i.push(a);if(!(i.length===0&&!o)){for(const a of i)n.delete(a),this.#e.delete(a);y(this.#t,{value:n})}}length(){return s(this.#t).value.size}isEmpty(){return this.length()===0}hasId(e){return s(this.#t).value.has(e)}items(e){const n=s(this.#t).value,r=[];for(const i of n.values()){const o=this.#e.get(i);r.push(e[o])}return r}clear(){ve(()=>s(this.#t)).value.size!==0&&y(this.#t,{value:new Set})}replaceWith(e){const n=ve(()=>s(this.#t)).value;ve(()=>e.length===n.size&&e.every(r=>n.has(r.id)))||y(this.#t,{value:new Set(e.map(r=>r.id))})}addAll(e){const n=ve(()=>s(this.#t)).value;for(const r of e)n.add(r.id);y(this.#t,{value:n})}remove(e){const n=ve(()=>s(this.#t)).value;n.has(e.id)&&(n.delete(e.id),y(this.#t,{value:n}))}}var Ku=R('<prop class="svelte-pkb5hn"></prop>');function Zt(t,e){let n=U(e,"value",15);const r=n();var i=Ku();te(()=>J(i,"style",`width: var(${e.name??""}, ${r??""}px)`)),vt(i,"clientWidth",n),E(t,i)}const Rn=new Map;let lr=!1;function So(){if(Rn.size===0){lr=!1;return}for(const[t,e]of Rn){const n=window.getComputedStyle(t);e(n.color)}requestAnimationFrame(So)}function Zu(t,e){return Rn.set(t,e),lr||(lr=!0,requestAnimationFrame(So)),()=>{Rn.delete(t),Rn.size===0&&(lr=!1)}}var Ju=R('<prop class="svelte-180nk1t"></prop>');function Br(t,e){ne(e,!0);let n=U(e,"value",15);const r=n();let i;rn(()=>Zu(i,a=>(n(a),void 0)));var o=Ju();De(o,a=>i=a,()=>i),te(()=>J(o,"style",`color: var(${e.name??""}, ${r??""})`)),E(t,o),re()}za();var $u=R('<div class="timeline-view--plotarea-background svelte-1ge3qn8"></div>');function ec(t){var e=$u();E(t,e)}var tc=R('<div class="svelte-1cm6qpo"></div>');function nc(t,e){ne(e,!0);let n=V(void 0);const r=C({left:0,top:0,right:0,bottom:0,width:0,height:0});Oe(()=>{e.onOffsetChange(r)});function i(){if(s(n)==null)return;r.left=s(n).offsetLeft??0,r.top=s(n).offsetTop??0,r.width=s(n).offsetWidth??0,r.height=s(n).offsetHeight??0;const a=s(n).offsetParent;a!=null&&(r.right=a.clientWidth-r.width-r.left,r.bottom=a.clientHeight-r.height-r.top)}rn(()=>{i();const a=setInterval(i,250);return()=>clearInterval(a)});var o=tc();De(o,a=>y(n,a),()=>s(n)),E(t,o),re()}let En;function Mo(t){En??=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}),En.clearRect(0,0,1,1),En.fillStyle=t,En.fillRect(0,0,1,1);const[e,n,r,i]=En.getImageData(0,0,1,1).data;return{r:e,g:n,b:r,a:i/255}}function rc(t,e){const n=Mo(t),r=e.a+n.a*(1-e.a),i=Math.round((e.r*e.a+n.r*n.a*(1-e.a))/r),o=Math.round((e.g*e.a+n.g*n.a*(1-e.a))/r),a=Math.round((e.b*e.a+n.b*n.a*(1-e.a))/r);return`rgba(${i}, ${o}, ${a}, ${r.toFixed(3)})`}class xi{constructor(e){this.color=e,this.#e=Mo(e),this.#e.a===0?this.blend=xi.#n:this.#e.a===1?this.blend=this.#t:this.blend=this.#i}#e;blend;#t(){return this.color}static#n(e){return e}#r=new Map;#i(e){const n=this.#r.get(e);if(n)return n;const r=rc(e,this.#e);return this.#r.set(e,r),r}}function ic(t,e,n){t.forEach(r=>r.scroll(e,n))}var sc=(t,e)=>{t.stopPropagation(),e(t)},oc=R('<div><div role="presentation" class="thumb svelte-17o9bpd"></div></div>');function hs(t,e){ne(e,!0);const n=jt();let r=U(e,"orientation",3,"vertical"),i=U(e,"min",3,0),o=U(e,"max",3,100),a=$n(e,["$$slots","$$events","$$legacy","orientation","controls","tabindex","value","visibleAmount","min","max"]),u=M(()=>o()-i()),l=M(()=>s(u)===0?1:e.visibleAmount/s(u)),c=M(()=>Math.max(0,s(u)-e.visibleAmount)),d=M(()=>s(c)===0?0:(e.value-i())/s(c)),h=V(void 0),f=V(!1);function p(I){const P=I.screenX,_=I.screenY,D=e.value,q=s(l),B=i(),le=o();let X=I.screenX,H=I.screenY;function ue(Me){s(f)||(y(f,!0),n("dragstart"));const F=Me.screenX-X,Q=Me.screenY-H;X=Me.screenX,H=Me.screenY;const ie=Me.screenX-P,j=Me.screenY-_;let he=0,Le=0;r()==="horizontal"?(he=F,Le=ie):(he=Q,Le=j);const Ue=he/q,Ne=Le/q,Dt=Math.max(B,Math.min(le,D+Ne));n("change",{dragging:!0,deltaPixels:he,deltaPixelsSinceStart:Le,deltaValue:Ue,deltaValueSinceStart:Ne,value:Dt,ratio:q,startValue:D})}function we(Me){s(f)&&(y(f,!1),n("dragend")),window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",we)}window.addEventListener("mousemove",ue),window.addEventListener("mouseup",we)}function v(I){if(s(h)===void 0)return;const P=I.offsetX,_=I.offsetY,D=(r()==="horizontal"?I.offsetX<s(h).offsetLeft:I.offsetY<s(h).offsetTop)?-1:1;function q(){if(s(h)===void 0)return;if(r()==="horizontal"){if(s(h).offsetLeft<=P&&s(h).offsetLeft+s(h).offsetWidth>=P)return}else if(s(h).offsetTop<=_&&s(h).offsetTop+s(h).offsetHeight>=_)return;let X=D*e.visibleAmount;const H=e.value+X,ue=Math.max(i(),Math.min(o(),H));ue!==H&&(X=ue-e.value);const we=X*s(l);n("change",{dragging:!1,value:ue,deltaValue:X,deltaPixels:we,ratio:s(l)})}q();const B=setInterval(q,50);function le(){clearInterval(B),window.removeEventListener("mouseup",le)}window.addEventListener("mouseup",le)}var g=oc(),b=I=>{I.target===I.currentTarget&&v(I)};let w;var x=Y(g);x.__mousedown=[sc,p],De(x,I=>y(h,I),()=>s(h)),te(()=>{w=Nr(g,w,{...a,role:"scrollbar","aria-hidden":s(l)>=.99999999999,"aria-orientation":r(),"aria-controls":e.controls,"aria-valuenow":e.value,"aria-valuemin":i(),"aria-valuemax":o(),tabindex:e.tabindex,onmousedown:b},"svelte-17o9bpd"),J(x,"style",`--percent: ${s(l)??""}; --value: ${s(d)??""};`),Ft(x,"dragging",s(f))}),E(t,g),re()}ln(["mousedown"]);var ac=R('<div class="svelte-1v10isr"></div> <!> <!>',1);function lc(t,e){ne(e,!0);let n=V(0),r=V(0),i=V(0),o=V(0);function a(){return s(i)}const u=M(()=>s(r)-s(n)),l=M(()=>s(o)-s(i));var c=ac(),d=pe(c),h=A(d,2);const f=M(()=>`--size: ${s(u)}px;`),p=M(()=>Math.min(0,e.minLeftOffset)),v=M(()=>Math.max(s(o),e.maxRightOffset));hs(h,{orientation:"horizontal",get style(){return s(f)},get controls(){return e.id},get tabindex(){return e.tabIndex},value:0,get visibleAmount(){return s(o)},get min(){return s(p)},get max(){return s(v)},$$events:{change(...x){e.onHScroll?.apply(this,x)},dragstart(...x){e.onThumbDragStart?.apply(this,x)},dragend(...x){e.onThumbDragEnd?.apply(this,x)}}});var g=A(h,2);const b=M(()=>`--size: ${s(l)}px;`),w=M(()=>e.tabIndex+1);return hs(g,{orientation:"vertical",get style(){return s(b)},get controls(){return e.id},get tabindex(){return s(w)},get value(){return e.scrollTop},get visibleAmount(){return s(r)},min:0,get max(){return e.scrollHeight},$$events:{change(...x){e.onVScroll?.apply(this,x)},dragstart(...x){e.onThumbDragStart?.apply(this,x)},dragend(...x){e.onThumbDragEnd?.apply(this,x)}}}),vt(d,"clientHeight",x=>y(n,x)),vt(d,"offsetHeight",x=>y(r,x)),vt(d,"clientWidth",x=>y(i,x)),vt(d,"offsetWidth",x=>y(o,x)),E(t,c),re({getClientWidth:a})}function uc(t,e,n,r,i){if(!e.editable||s(n)!=null)return;const o=e.focalValue-e.scale.toValue(r.width/2),a=e.scale.toValue(t.offsetX),u=o+a;i("create",{value:u,cause:t})}function cc(t,e){e(t)}var fc=(t,e,n,r,i,o,a,u)=>{switch(t.key){case"ArrowLeft":e("scrollX",n.scale.toValue(-10));break;case"ArrowRight":e("scrollX",n.scale.toValue(10));break;case"ArrowUp":r(s(i)-10);break;case"ArrowDown":r(s(i)+10);break;case"PageUp":r(s(i)-o.height);break;case"PageDown":r(s(i)+o.height);break;case"Home":r(0);break;case"End":r(s(a));break;case"Tab":u(t.shiftKey)&&(t.stopPropagation(),t.preventDefault());break}},dc=R('<div class="timeline-view--plotarea svelte-1yksuc0"><!> <!> <!> <!> <canvas class="svelte-1yksuc0"></canvas> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>');function hc(t,e){ne(e,!0);const n=jt();let r=U(e,"onPreviewNewItemValue",3,(m,k)=>k),i=U(e,"oncontextmenu",3,()=>{}),o=U(e,"onItemsChanged",3,async()=>{}),a=V(void 0),u=V(void 0);const l=C({width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}}),c=C({size:16,radius:8,color:"darkgray",selected:{borderWidth:2,color:"black",borderColor:"black"},margin:{horizontal:0,vertical:0,top:2,right:2,bottom:2,left:2}}),d=M(()=>new xi(c.selected.color));function h(){return{size:l.width,padding:{start:l.padding.left,end:l.padding.right},items:{size:c.size,margin:{start:c.margin.left,end:c.margin.right}}}}const f=M(()=>e.sortedItems.map(An.from)),p=M(()=>(ju(e.scale,s(f)),{items:s(f),_:Math.random()}));Oe(()=>{const m=s(O);if(m!=null&&(m.index>=s(f).length||s(f).find(k=>k.id===m.id)===void 0)){if(m.index>=s(f).length){y(O,null);return}const k=s(f).findIndex(N=>N.id===m.id);if(k===-1){y(O,null);return}k!==m.index&&(m.index=k)}});const v=M(()=>{const m=s(p).items;return Gu(c.size,c.margin,m),{items:m,_:Math.random()}}),g=M(()=>{const m=l.padding;let k=m.top;const N=m.top+m.bottom;return s(v).items.forEach(z=>k=Math.max(k,z.layoutBottom+N)),k});Oe(()=>{const m=s(O);if(m!==null){const k=s(v).items[m.index];if(k==null)return;G(k),Pe(k)}});const b=M(()=>Math.max(0,s(g)-l.height));let w=V(0);function x(m){y(w,C(Math.max(0,Math.min(ve(()=>s(b)),m))))}Oe(()=>{ve(()=>s(w))>s(b)&&x(s(b))});const I=M(()=>e.scale.toPixels(e.focalValue)-l.width/2),P=M(()=>{const m=s(v).items,k=s(w)-l.padding.top,N=s(I);return ic(m,k,N),{items:m,_:Math.random()}}),_=M(()=>{const m=s(f),k=c.color;if(j.isEmpty())return m.forEach(me=>{const ye=me.color();me.backgroundColor=ye??k,me.borderColor=ye??k,me.strokeWidth=0}),{items:m,_:Math.random()};const N=s(d),z={color:c.selected.borderColor,width:c.selected.borderWidth};return m.forEach(me=>{const ye=me.color();j.hasId(me.id)?(me.backgroundColor=N.blend(ye??k),me.borderColor=z.color,me.strokeWidth=z.width):(me.backgroundColor=ye??k,me.borderColor=ye??k,me.strokeWidth=0)}),{items:m,_:Math.random()}});Oe(()=>{const m=s(a);if(m===void 0)return;const k=l.width,N=l.height,z=s(P).items;s(_).items;const me=s(H)?.arr()??null,ye=c.radius,st=requestAnimationFrame(function(){const Ee=m.getContext("2d");if(Ee==null)return;const ee=activeWindow.devicePixelRatio||1;(m.width!=k*ee||m.height!=N*ee)&&(m.width=k*ee,m.height=N*ee,m.style.width=k+"px",m.style.height=N+"px",Ee.scale(ee,ee)),Nu(Ee,l,ye,z,me)});return()=>{cancelAnimationFrame(st)}});const D=M(()=>s(P).items);Oe(()=>{const m=s($);if(m instanceof Ne){const k=s(P).items;if(m.element.offsetContains(m.pos[0],m.pos[1]))return;const N=k.find(z=>z.offsetContains(m.pos[0],m.pos[1]));N===void 0?y($,null):m.element=N}});function q(m){if(m.shiftKey)n("scrollX",e.scale.toValue(m.deltaY)),m.deltaX!==0&&x(s(w)+m.deltaX);else if(m.ctrlKey){const N=m.clientX-s(u).getBoundingClientRect().left-l.width/2,z=e.focalValue+e.scale.toValue(N);m.deltaY>0?n("zoomOut",{keepValue:z,at:N,within:l.width}):m.deltaY<0&&n("zoomIn",{keepValue:z,at:N,within:l.width})}else x(s(w)+m.deltaY),m.deltaX!==0&&n("scrollX",e.scale.toValue(m.deltaX))}let B=V(!1),le=null;class X{onFinished;#e=V(C([]));get elements(){return s(this.#e)}set elements(k){y(this.#e,C(k))}constructor(k,N){this.onFinished=N,this.elements=k.map(z=>(z.hide(),new Xu(z,z.item.startValue(),z.item.length(),z.item.startValue()+z.item.length(),z.offsetLeft+z.minSize/2,z.backgroundColor,z.borderColor,z.strokeWidth)))}forEach(k){this.elements.forEach(k),this.elements=this.elements.slice()}singleOrNull(){return this.elements.length===1?this.elements[0]:null}arr(){return this.elements}async finish(){try{await this.onFinished(this.movedItems())}finally{this.elements.forEach(k=>k.base.show())}}movedItems(){return this.elements.map(k=>({value:k.value,length:k.length,endValue:k.endValue,item:k.base.item}))}}let H=V(null);function ue(m){return Cs.Platform.isMacOS&&m.metaKey||m.ctrlKey}function we(m,k,N,z){y(ie,C({offsetLeft:m,offsetTop:k,offsetWidth:N,offsetHeight:z}))}function Me(m){if(y(B,!0),!(s($)instanceof Ne)||s($).element==null){if(y(O,null),s(he)!==null&&Yr(s(he),m.offsetX,m.offsetY)&&F(m))return;ue(m)||j.clear(),Le(m);return}if(m.button===2){Te(s($).element,s(D).indexOf(s($).element));return}le=s($).element,j.hasId(le.id)||(ue(m)?j.addAll([le]):j.replaceWith([le])),s($).side==="middle"?F(m):Q(m,s($).side==="right")}function F(m){if(j.isEmpty())return!1;const k=j.items(s(f)),N=s(u).getBoundingClientRect(),z=e.focalValue-e.scale.toValue(l.width/2)-e.scale.toValue(s(u).getBoundingClientRect().left)+e.scale.toValue(m.clientX);function me(st){const Tt=st.clientX,ee=e.focalValue-e.scale.toValue(l.width/2)-e.scale.toValue(s(u).getBoundingClientRect().left)+e.scale.toValue(st.clientX)-z;if(s(H)===null&&y(H,C(new X(k,o()))),s(H).forEach(Ve=>{const kt=Ve.base,Qt=r()(kt.item,kt.value()+ee),un=r()(kt.item,Qt+kt.item.length()),Kt=e.scale.toPixels(Qt-e.focalValue)+l.width/2;Ve.value=Qt,Ve.endValue=un,Ve.length=un-Qt,Ve.offsetCenterX=Kt,Ve.offsetLeft=Kt-kt.minSize/2,Ve.offsetRight=Kt+kt.offsetWidth}),Tt<N.left+l.padding.left){const Ve=Tt-(N.left+l.padding.left);n("scrollX",e.scale.toValue(Ve))}else if(Tt>N.right-l.padding.right){const Ve=Tt-(N.right-l.padding.right);n("scrollX",e.scale.toValue(Ve))}}async function ye(){try{await s(H)?.finish()}finally{y(H,null)}window.removeEventListener("mousemove",me),window.removeEventListener("mouseup",ye)}return e.editable?(window.addEventListener("mouseup",ye),window.addEventListener("mousemove",me),!0):!1}function Q(m,k){if(!e.editable||j.isEmpty())return;const N=j.items(s(f)),z=e.focalValue-e.scale.toValue(l.width/2)-e.scale.toValue(s(u).getBoundingClientRect().left)+e.scale.toValue(m.clientX);function me(st){const Ee=e.focalValue-e.scale.toValue(l.width/2)-e.scale.toValue(s(u).getBoundingClientRect().left)+e.scale.toValue(st.clientX)-z;s(H)===null&&y(H,C(new X(N,o()))),k?s(H).forEach(ee=>{const Ve=ee.base;ee.length=Ve.item.length()+Ee,ee.endValue=ee.value+ee.length,ee.offsetWidth=e.scale.toPixels(ee.length)+Ve.minSize,ee.offsetRight=ee.offsetLeft+ee.offsetWidth}):s(H).forEach(ee=>{const Ve=ee.base;ee.value=Ve.item.startValue()+Ee,ee.length=ee.endValue-ee.value,ee.offsetWidth=e.scale.toPixels(ee.length)+Ve.minSize,ee.offsetLeft=ee.offsetRight-ee.offsetWidth})}const ye=is(window,"mousemove",me);is(window,"mouseup",async()=>{ye();try{await s(H)?.finish()}finally{y(H,null)}},{once:!0})}let ie=V(null);const j=new Qu;Oe(()=>j.updateItems(s(f)));const he=M(()=>{if(j.length()<=1)return null;let m=-1/0,k=-1/0;const N={offsetLeft:1/0,offsetTop:1/0,offsetWidth:0,offsetHeight:0};for(const z of j.items(s(P).items))N.offsetLeft=Math.min(N.offsetLeft,z.offsetLeft),N.offsetTop=Math.min(N.offsetTop,z.offsetTop),m=Math.max(m,z.offsetRight),k=Math.max(k,z.offsetBottom);return N.offsetWidth=m-N.offsetLeft,N.offsetHeight=k-N.offsetTop,N});function Le(m){const k=s(u).getBoundingClientRect(),N=m.clientX-k.left,z=e.focalValue,me=m.clientY-k.top+s(w);let ye=!1;function st(Ee){const ee=N-e.scale.toPixels(e.focalValue-z),Ve=me-s(w),kt=Ee.clientX-k.left,Qt=Ee.clientY-k.top,un=Math.min(ee,kt),Kt=Math.min(Ve,Qt),Yi=Math.max(ee,kt),Qo=Math.max(Ve,Qt),Or=Yi-un,Fr=Qo-Kt;if(!ye&&Or<5&&Fr<5)return;ye=!0;const Dr=[];for(let ot=0;ot<s(D).length;ot++){const Lr=s(D)[ot];if(Lr.offsetLeft>Yi)break;Lr.offsetIntersects(un,Kt,Or,Fr)&&Dr.push(Lr)}if(we(un,Kt,Or,Fr),ue(Ee)?j.addAll(Dr):j.replaceWith(Dr),Ee.clientX<k.left+l.padding.left){const ot=Ee.clientX-(k.left+l.padding.left);n("scrollX",e.scale.toValue(ot))}else if(Ee.clientX>k.right-l.padding.right){const ot=Ee.clientX-(k.right-l.padding.right);n("scrollX",e.scale.toValue(ot))}if(Ee.clientY<k.top+l.padding.top){const ot=Ee.clientY-(k.top+l.padding.top);x(s(w)+ot)}else if(Ee.clientY>k.bottom){const ot=Ee.clientY-(k.bottom-l.padding.bottom);x(s(w)+ot)}}function Tt(){y(ie,null),window.removeEventListener("mousemove",st),window.removeEventListener("mouseup",Tt)}window.addEventListener("mouseup",Tt),window.addEventListener("mousemove",st)}function Ue(m){if(m.button===2){if(s(he)!==null&&Yr(s(he),m.offsetX,m.offsetY)){i()(m,j.items(s(f)).map(z=>z.item));return}if(!(s($)instanceof Ne)||s($).element==null)return;i()(m,[s($).element.item]);return}if(le==null)return;const k=le;if(le=null,!(s($)instanceof Ne)||s($).element==null||s($).element!==k)return;y(O,null);const N=s($).element.item;y($,null),ue(m)||n("select",{item:N,causedBy:m})}class Ne{#e=V(void 0);get element(){return s(P).items,s(this.#e)}set element(k){y(this.#e,C(k))}side;pos;constructor(k,N,z){this.element=k,this.side=N,this.pos=z}}const Dt=Symbol();let $=V(null);class Vn{#e=null;get id(){return this.#e}get element(){return s(P).items[this.index]??null}#t=V(-1);get index(){return s(this.#t)}set index(k){y(this.#t,C(k))}constructor(k,N){this.index=k,this.#e=N.id}}let O=V(null);function G(m){m.offsetTop<0?x(m.layoutTop-l.padding.top-c.margin.top):m.offsetBottom>l.height&&x(m.layoutBottom-l.height+l.padding.bottom+c.margin.bottom)}function Pe(m){(m.offsetLeft<0||m.offsetRight>l.width)&&n("scrollToValue",m.item.startValue())}function Te(m,k,N=!1){N||n("focus",m.item),y(O,C(new Vn(k,m))),G(m),Pe(m)}function ke(m=!1){const k=s(O)==null?0:m?s(O).index-1:s(O).index+1;return k<s(D).length&&k>=0?(Te(s(D)[k],k),!0):(y(O,null),!1)}function Ie(m){const k=s(D).findIndex(N=>N.item.id===m);k>=0&&Te(s(D)[k],k,!0)}let S=V(!1);function T(m){if(!s(S)&&s(H)==null&&s(ie)==null){for(let k=0;k<s(D).length;k++){const N=s(D)[k];if(N.offsetContains(m.offsetX,m.offsetY)){let z="middle";e.itemsResizable&&(m.offsetX<N.offsetLeft+N.minSize/4?z="left":m.offsetX>=N.offsetRight-N.minSize/4&&(z="right")),y($,C(new Ne(N,z,[m.offsetX,m.offsetY])));return}}if(s(he)!=null&&Yr(s(he),m.offsetX,m.offsetY)){y($,C(Dt));return}}y($,null)}let L=V(null);function W(){return s(L)?.getClientWidth()??0}function se(m){n("scrollToValue",e.focalValue+e.scale.toValue(m.detail.deltaPixels)/m.detail.ratio)}function Z(m){x(m.detail.value)}const be="timeline-view--plotarea-"+Math.random().toString(36).slice(2);var oe=dc();J(oe,"id",be);var nt=Y(oe);ec(nt);var rt=A(nt,2);nc(rt,{onOffsetChange:m=>{l.padding.top=m.top,l.padding.left=m.left,l.padding.right=m.right,l.padding.bottom=m.bottom}});var Nn=A(rt,2);Co(Nn,{get area(){return s(ie)}});var Gt=A(Nn,2);const Bo=M(()=>j.length());qu(Gt,{get bounds(){return s(he)},get selectedItemCount(){return s(Bo)}});var it=A(Gt,2);J(it,"tabindex",0),it.__mousemove=[cc,T],it.__mousedown=Me,it.__mouseup=Ue,it.__dblclick=[uc,e,$,l,n],it.__keydown=[fc,n,e,x,w,l,b,ke],De(it,m=>y(a,m),()=>s(a));var Mi=A(it,2);{var qo=m=>{const k=M(()=>e.summarizeItem(s($).element.item));Wu(m,{get position(){return s($).element},get summary(){return s(k)}})};xe(Mi,m=>{s($)instanceof Ne&&m(qo)})}var Ii=A(Mi,2);{var Ho=m=>{var k=ze();const N=M(()=>s(H).singleOrNull());var z=pe(k);{var me=ye=>{const st=M(()=>e.previewItem(s(N).base.item,s(N).base.name(),s(N).value,s(N).length,s(N).value+s(N).length));Uu(ye,{get position(){return s(N)},get summary(){return s(st)}})};xe(z,ye=>{s(N)!==null&&ye(me)})}E(m,k)};xe(Ii,m=>{s(H)!=null&&m(Ho)})}var Vi=A(Ii,2);{var Uo=m=>{var k=ze();const N=M(()=>s(O).element);var z=pe(k);{var me=ye=>{Yu(ye,{get focus(){return s(N)}})};xe(z,ye=>{s(N)!==null&&ye(me)})}E(m,k)};xe(Vi,m=>{s(O)!=null&&m(Uo)})}var Ni=A(Vi,2);const Xo=M(()=>s(P).items[0]?.offsetLeft??0),jo=M(()=>s(P).items[s(P).items.length-1]?.offsetRight??0);De(lc(Ni,{get tabIndex(){return e.sortedItems.length},id:be,get scrollHeight(){return s(g)},get scrollTop(){return s(w)},get minLeftOffset(){return s(Xo)},get maxRightOffset(){return s(jo)},onVScroll:Z,onHScroll:se,onThumbDragStart:()=>{y(S,!0)},onThumbDragEnd:()=>{y(S,!1)}}),m=>y(L,C(m)),()=>s(L));var Ei=A(Ni,2);Zt(Ei,{name:"--item-margin-top",get value(){return c.margin.top},set value(m){c.margin.top=m}});var Oi=A(Ei,2);Zt(Oi,{name:"--item-margin-left",get value(){return c.margin.left},set value(m){c.margin.left=m}});var Fi=A(Oi,2);Zt(Fi,{name:"--item-margin-bottom",get value(){return c.margin.bottom},set value(m){c.margin.bottom=m}});var Di=A(Fi,2);Zt(Di,{name:"--item-margin-right",get value(){return c.margin.right},set value(m){c.margin.right=m}});var Li=A(Di,2);Zt(Li,{name:"--item-size",get value(){return c.size},set value(m){c.size=m}});var Ai=A(Li,2);Zt(Ai,{name:"--item-radius",get value(){return c.radius},set value(m){c.radius=m}});var Ri=A(Ai,2);Br(Ri,{name:"--item-color",get value(){return c.color},set value(m){c.color=m}});var Wi=A(Ri,2);Zt(Wi,{name:"--selected-item-border-width",get value(){return c.selected.borderWidth},set value(m){c.selected.borderWidth=m}});var zi=A(Wi,2);Br(zi,{name:"--selected-item-color",get value(){return c.selected.color},set value(m){c.selected.color=m}});var Go=A(zi,2);return Br(Go,{name:"--selected-item-border-color",get value(){return c.selected.borderColor},set value(m){c.selected.borderColor=m}}),De(oe,m=>y(u,m),()=>s(u)),te(()=>{J(oe,"aria-readonly",!e.editable),J(oe,"data-hover-over-selection",s($)===Dt),J(oe,"data-hover-side",s($)instanceof Ne?s($).side:void 0),Ft(oe,"hovered",s($)!=null),Ce(oe,"--cross-axis-scroll",`${s(w)??""}px`)}),Bt("wheel",it,m=>{m.stopPropagation(),q(m)},!0),Bt("mouseleave",it,()=>y($,null)),Bt("focus",it,m=>{!s(B)&&ke()&&(m.stopPropagation(),m.preventDefault()),y(B,!1)}),vt(oe,"offsetWidth",m=>l.width=m),vt(oe,"offsetHeight",m=>l.height=m),E(t,oe),re({fitBounds:h,focusOnId:Ie,clientWidth:W})}ln(["mousemove","mousedown","mouseup","dblclick","keydown"]);var mc=R("<div></div>");function Ke(t,e){ne(e,!0);let n=U(e,"id",7),r=V(void 0);function i(u,l){if(l==null)return;l.empty(),de.setIcon(l,u);const c=l.firstChild;c instanceof SVGElement&&l.replaceWith(c)}Hn(()=>{i(n(),s(r))});var o=ze(),a=pe(o);return El(a,n,u=>{var l=mc();De(l,c=>y(r,c),()=>s(r)),E(u,l)}),E(t,o),re({get id(){return n()},set id(u){n(u)}})}var pc=R("<button><!></button>");function ut(t,e){ne(e,!0);let n=$n(e,["$$slots","$$events","$$legacy","children"]);const r=jt();function i(d){r("action",{inputEvent:d})}function o(d){d.key==="Enter"&&(d.preventDefault(),r("action",{inputEvent:d}))}var a=pc(),u=d=>{d.preventDefault(),i(d)};let l;var c=Y(a);tt(c,()=>e.children??ge),te(()=>l=Nr(a,l,{...n,onclick:u,onkeydown:o})),E(t,a),re()}var vc=R('<li class="timeline-view--control-group svelte-ee8ctt"><!></li>');function Pi(t,e){var n=vc(),r=Y(n);tt(r,()=>e.children??ge),E(t,n)}const hn="timeline-view--control-item";var gc=R('<menu class="timeline-view--nav-controls svelte-ibapcd"><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li></menu>');function yc(t,e){ne(e,!0);function n(){e.navigation.zoomIn()}function r(){e.navigation.zoomOut()}function i(){e.navigation.zoomToFit()}function o(){e.navigation.scrollToValue(0)}function a(){e.navigation.scrollToFirst()}Pi(t,{children:(u,l)=>{var c=gc(),d=Y(c);lt(d,At(hn),"svelte-ibapcd");var h=Y(d);ut(h,{"aria-label":"Zoom In","data-tooltip-position":"left",class:"clickable-icon",$$events:{action:n},children:(P,_)=>{Ke(P,{id:"plus"})},$$slots:{default:!0}});var f=A(d,2);lt(f,At(hn),"svelte-ibapcd");var p=Y(f);ut(p,{"aria-label":"Zoom Out","data-tooltip-position":"left",class:"clickable-icon",$$events:{action:r},children:(P,_)=>{Ke(P,{id:"minus"})},$$slots:{default:!0}});var v=A(f,2);lt(v,At(hn),"svelte-ibapcd");var g=Y(v);ut(g,{"aria-label":"Zoom to Fit","data-tooltip-position":"left",class:"clickable-icon",$$events:{action:i},children:(P,_)=>{Ke(P,{id:"scan"})},$$slots:{default:!0}});var b=A(v,2);lt(b,At(hn),"svelte-ibapcd");var w=Y(b);ut(w,{"aria-label":"Scroll to Zero","data-tooltip-position":"left",class:"clickable-icon",$$events:{action:o},children:(P,_)=>{Ke(P,{id:"arrow-left-to-line"})},$$slots:{default:!0}});var x=A(b,2);lt(x,At(hn),"svelte-ibapcd");var I=Y(x);ut(I,{"aria-label":"Scroll to First","data-tooltip-position":"left",class:"clickable-icon",$$events:{action:a},children:(P,_)=>{Ke(P,{id:"arrow-left"})},$$slots:{default:!0}}),E(u,c)}}),re()}var wc=R('<details class="timeline-view--timeline-settings svelte-1sruo5l"><summary class="svelte-1sruo5l"><!></summary> <form><!></form></details>');function bc(t,e){ne(e,!0);const n=eu();let r=V(!e.collapsable.isCollapsed());function i(a){y(r,!a.isCollapsed())}function o(a){a?e.collapsable.collapse():e.collapsable.expand(),y(r,!e.collapsable.isCollapsed())}Hn(()=>{i(e.collapsable)}),Hn(()=>{o(!s(r))}),Pi(t,{children:(a,u)=>{var l=wc(),c=Y(l),d=Y(c);{var h=b=>{ut(b,{class:"toggle-button open-button clickable-icon","aria-label":"Settings","data-tooltip-position":"left",$$events:{action:()=>y(r,!0)},children:(w,x)=>{Ke(w,{id:"settings"})},$$slots:{default:!0}})},f=b=>{ut(b,{class:"toggle-button close-button clickable-icon","aria-label":"Close","data-tooltip-position":"left",$$events:{action:()=>y(r,!1)},children:(w,x)=>{Ke(w,{id:"x"})},$$slots:{default:!0}})};xe(d,b=>{s(r)?b(f,!1):b(h)})}var p=A(c,2),v=M(()=>jl(Gl(n("submit")))),g=Y(p);tt(g,()=>e.children??ge),te(()=>l.open=s(r)),Bt("submit",p,function(...b){s(v)?.apply(this,b)}),E(a,l)}}),re()}function Qe(t){return{parseOrDefault(e){return this.check(e)?e:t},check(e){return typeof e=="string"}}}function qr(t){return{parseOrDefault(e){return this.check(e)?e:t},check(e){return typeof e=="number"}}}function at(t){return{parseOrDefault(e){return this.check(e)?e:t},check(e){return typeof e=="boolean"}}}function _c(t){return{parseOrDefault(e){if(this.check(e))return t.parseOrDefault(e)},check(e){return typeof e>"u"||t.check(e)}}}function ti(t,e){const n=Object.fromEntries(Object.entries(t).map(([r,i])=>[i,r]));return{parseOrDefault(r){return this.check(r)?r:e},check(r){return(typeof r=="string"||typeof r=="number")&&r in n}}}function Io(t,e){return{parseOrDefault(n){return Array.isArray(n)?n.map(r=>t.parseOrDefault(r)):Array.from({length:0},()=>t.parseOrDefault(null))},check(n){return Array.isArray(n)&&n.every(t.check)&&!0}}}function Xe(t){return{parseOrDefault(e){const n={};if(typeof e!="object"||e==null){for(const[r,i]of Object.entries(t)){const o=r,a=i;n[o]=a.parseOrDefault(null)}return n}for(const[r,i]of Object.entries(t)){const o=r,a=i;n[o]=a.parseOrDefault(e[o])}return n},check(e){if(typeof e!="object"||e==null)return!1;for(const[n,r]of Object.entries(t)){const i=n;if(!r.check(e[i]))return!1}return!0}}}function xc(t){return{parseOrDefault(e){if(typeof e!="object"||e==null)return{};const n=Object.entries(e).map(([r,i])=>t.key.check(r)?[r,t.value.parseOrDefault(i)]:null).filter(ri);return Object.fromEntries(n)},check(e){return typeof e!="object"||e==null?!1:Object.entries(e).every(([n,r])=>t.key.check(n)&&t.value.check(r))}}}var Pc=R('<input type="color" data-tooltip-position="left" class="svelte-1q65o6o">');function Tc(t,e){let n=U(e,"onmousedown",3,void 0),r=U(e,"color",15);var i=Pc();J(i,"aria-label",`Click to change color
Drag to reorder groups`),i.__mousedown=function(...o){n()?.apply(this,o)},yi(i,r),E(t,i)}ln(["mousedown"]);var kc=R('<input type="text" spellcheck="false" placeholder="Enter query...">');function Cc(t,e){let n=U(e,"query",15);var r=kc();yi(r,n),E(t,r)}class Tn{#e=V("");query(){return s(this.#e)}filterByQuery(e){y(this.#e,C(e))}#t=V("");color(){return s(this.#t)}recolor(e){y(this.#t,C(e))}saveState(){return{query:s(this.#e),color:s(this.#t)}}constructor(e,n){this.#e.v=C(e),this.#t.v=C(n)}static#n=Xe({query:Qe(""),color:Qe("")});static fromSavedState(e){const n=Tn.#n.parseOrDefault(e);return new Tn(n.query,n.color)}}var Sc=Vl('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>'),Mc=R("<li><!> <!> <!></li>");function Hr(t,e){ne(e,!0);let n=U(e,"class",3,void 0),r=U(e,"style",3,void 0),i=U(e,"onRemove",3,void 0),o=U(e,"onPressDragHandle",3,void 0),a=V(null);function u(w){if(o()&&s(a)){const x=s(a),I=s(a).getBoundingClientRect();o()({get currentTarget(){return x},offsetX:w.clientX-I.x,offsetY:w.clientY-I.y,clientX:w.clientX,clientY:w.clientY})}}var l=Mc(),c=Y(l),d=()=>e.group.query(),h=w=>e.group.filterByQuery(w);Cc(c,{get query(){return d()},set query(w){h(w)}});var f=A(c,2),p=()=>e.group.color(),v=w=>e.group.recolor(w);const g=M(()=>o()?u:void 0);Tc(f,{get color(){return p()},set color(w){v(w)},get onmousedown(){return s(g)}});var b=A(f,2);ut(b,{class:"clickable-icon","aria-label":"Delete group","data-tooltip-position":"left",$$events:{action:()=>i()?.()},children:(w,x)=>{var I=Sc();E(w,I)},$$slots:{default:!0}}),De(l,w=>y(a,w),()=>s(a)),te(()=>{lt(l,`timeline-view-color-group ${n()??""} svelte-1lhylhn`),J(l,"style",r())}),E(t,l),re()}function Ic(t,e){let n=$n(e,["$$slots","$$events","$$legacy","children"]);ut(t,$l({class:"mod-cta"},()=>n,{$$events:{action(r){Ql.call(this,e,r)}},children:(r,i)=>{var o=ze(),a=pe(o);tt(a,()=>e.children??ge),E(r,o)},$$slots:{default:!0}}))}var Vc=R("<dialog><!></dialog>");function Nc(t,e){ne(e,!0);const n=U(e,"open",3,!1);let r=V(null);Oe(()=>{s(r)!==null&&s(r).parentElement!==s(r).ownerDocument?.body&&s(r).ownerDocument?.body?.appendChild(s(r))});var i=Vc(),o=Y(i);tt(o,()=>e.children??ge),De(i,a=>y(r,a),()=>s(r)),te(()=>{i.open=n(),lt(i,At(e.class),"svelte-1tcvzth"),Ce(i,"top",e.top),Ce(i,"left",e.left)}),E(t,i),re()}const ms=["#e05252","#e0b152","#b1e052","#52e052","#52e0b1","#52b1e0","#5252e0","#b152e0","#e052b1"];class Vo{#e=V(C([]));list(){return s(this.#e)}appendNewGroup(){s(this.#e).push(new Tn("",ms[s(this.#e).length%ms.length]))}reorder(e,n){if(e===n)return null;const r=s(this.#e).splice(e,1);return s(this.#e).splice(n,0,r[0]),r[0]}removeIndex(e){e<0||e>=s(this.#e).length||s(this.#e).splice(e,1)}observe(e){return so(()=>{Oe(()=>e(this))})}saveState(){return this.list().map(e=>e.saveState())}constructor(e){this.#e.v=C(e.slice())}}var Ec=R('<div class="svelte-1a12flq"><!></div>'),Oc=R('<ol class="group-list svelte-1a12flq" role="list"><!></ol> <div class="graph-color-button-container svelte-1a12flq"><!></div> <!>',1);function No(t,e){ne(e,!0);let n=V(null),r=V(void 0);function i(v,g){if(s(r)===void 0)return;const b=v,w=g.currentTarget.offsetHeight,x=g.currentTarget.offsetWidth,I=s(r).clientHeight/e.groups.list().length;function P(D){s(r)!==void 0&&y(n,C({index:b,offsetHeight:I,overIndex:Math.max(0,Math.floor((D.clientY-s(r).getBoundingClientRect().top)/I)),imgPos:{top:D.clientY-g.offsetY,left:D.clientX-g.offsetX,height:w,width:x}}))}function _(){window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",_);try{s(n)!=null&&e.groups.reorder(b,Math.min(e.groups.list().length-1,s(n).overIndex))}finally{y(n,null)}}window.addEventListener("mousemove",P),window.addEventListener("mouseup",_)}var o=Oc(),a=pe(o),u=Y(a);{var l=v=>{var g=ze(),b=pe(g);Ut(b,17,()=>e.groups.list(),Ht,(w,x,I)=>{const P=M(()=>e.groups.removeIndex.bind(e.groups,I));Hr(w,{get group(){return s(x)},get onRemove(){return s(P)},onPressDragHandle:_=>i(I,_)})}),E(v,g)},c=v=>{var g=ze();const b=M(()=>s(n).index);var w=pe(g);Ut(w,17,()=>e.groups.list().filter((x,I)=>I!==s(b)),Ht,(x,I,P)=>{const _=M(()=>s(n).overIndex>=0&&P>=s(n).overIndex?"displaced":"");Hr(x,{get group(){return s(I)},get class(){return s(_)}})}),E(v,g)};xe(u,v=>{s(n)==null?v(l):v(c,!1)})}De(a,v=>y(r,v),()=>s(r));var d=A(a,2),h=Y(d);Ic(h,{$$events:{action:()=>e.groups.appendNewGroup()},children:(v,g)=>{var b=vi("New group");E(v,b)},$$slots:{default:!0}});var f=A(d,2);{var p=v=>{Nc(v,{open:!0,get top(){return`${s(n).imgPos.top??""}px`},get left(){return`${s(n).imgPos.left??""}px`},children:(g,b)=>{var w=Ec(),x=Y(w);Hr(x,{get group(){return e.groups.list()[s(n).index]},get style(){return`width:${s(n).imgPos.width??""}px;height:${s(n).imgPos.height??""}px;pointer-events:none;`}}),E(g,w)},$$slots:{default:!0}})};xe(f,v=>{s(n)!=null&&v(p)})}te(()=>{Ft(a,"dragging",s(n)!=null),Ce(a,"--form-height",`${s(n)?.offsetHeight??0}px`)}),E(t,o),re()}function Fc(t){return--t*t*t*t*t+1}var Dc=R("<!> ",1),Lc=R('<div class="content"><!></div>'),Ac=R("<section><!> <!></section>");function Ti(t,e){let n=U(e,"class",3,""),r=U(e,"tabindex",3,0),i=U(e,"collapsed",15,!0);function o(){i(!i())}var a=Ac(),u=Y(a);const l=M(()=>!i()),c=M(()=>i()?"is-collapsed":"");ut(u,{get tabindex(){return r()},get"aria-expanded"(){return s(l)},get class(){return`header clickable-icon collapse-icon ${s(c)??""}`},$$events:{action:o},children:(f,p)=>{var v=Dc(),g=pe(v);Ke(g,{id:"right-triangle"});var b=A(g);te(()=>Et(b,` ${e.name??""}`)),E(f,v)},$$slots:{default:!0}});var d=A(u,2);{var h=f=>{var p=Lc(),v=Y(p);tt(v,()=>e.children??ge),wo(3,p,()=>Au,()=>({delay:0,duration:200,easing:Fc,axis:"y"})),E(f,p)};xe(d,f=>{i()||f(h)})}te(()=>{lt(a,`collapsable ${n()??""} svelte-1dp90dm`),Ft(a,"is-collapsed",i())}),E(t,a)}var Rc=R('<span class="group-update-progress svelte-q72r02" role="progressbar"><!> </span>'),Wc=R("<!> <!>",1);function zc(t,e){ne(e,!0);let n=U(e,"collapsed",15);Ti(t,{name:"Groups",class:"timeline-settings-groups-section",get collapsed(){return n()},set collapsed(r){n(r)},children:(r,i)=>{var o=Wc(),a=pe(o);{var u=c=>{var d=Rc(),h=Y(d);Ke(h,{id:"loader-2"});var f=A(h);te(p=>{J(d,"aria-valuenow",e.pendingGroupUpdates),Et(f,` ${p??""} pending`)},[()=>e.pendingGroupUpdates.toLocaleString()]),E(c,d)};xe(a,c=>{e.pendingGroupUpdates>0&&c(u)})}var l=A(a,2);No(l,{get groups(){return e.groups}}),E(r,o)},$$slots:{default:!0}}),re()}class Yc{#e;constructor(e=!0){this.#e=e}isCollapsed(){return this.#e}collapse(){this.#e=!0,this.onChange()}expand(){this.#e=!1,this.onChange()}onChange(){}}var Bc=R('<span class="setting-hotkey"> </span>'),qc=R('<div class="instruction svelte-1xilpa8"><div class="instruction-label"> </div> <div class="instruction-desc svelte-1xilpa8"></div></div>'),Hc=R('<div class="timeline-help svelte-1xilpa8"></div>');function Uc(t){const e={pan:["Scroll","Home","End","Page Up","Page Down","Arrow Up","Arrow Down"],"pan horizontal":["Shift + Scroll","Arrow Left","Arrow Right"],zoom:["Ctrl + Scroll"],"zoom to fit":["Shift + Space"],"focus on item":["Right Click"],"focus on next item":["Tab"],"focus on previous item":["Shift + Tab"],"move items in selection":["Click + Drag"],"extend selection":["Ctrl + Click"],"create new item":["Double Click"]};var n=Hc();Ut(n,5,()=>Object.entries(e),Ht,(r,i)=>{let o=()=>s(i)[0],a=()=>s(i)[1];var u=qc(),l=Y(u),c=Y(l),d=A(l,2);Ut(d,5,a,Ht,(h,f)=>{var p=Bc(),v=Y(p);te(()=>Et(v,s(f))),E(h,p)}),te((h,f)=>Et(c,`${h??""}${f??""}`),[()=>o()[0].toLocaleUpperCase(),()=>o().slice(1)],_n),E(r,u)}),E(t,n)}class Xc{constructor(e){this.source=e}get id(){return this.source.id}name(){return this.source.name()}color(){return this.source.color()}#e=V(0);startValue(){return s(this.#e)}setStartValue(e){y(this.#e,C(e))}#t=V(0);length(){return s(this.#t)}setLength(e){y(this.#t,C(e))}}function jc(t){return new Xc(t)}var Gc=R('<menu class="timeline-view--controls svelte-1rbd6pl"><!></menu>');function Qc(t,e){var n=Gc(),r=Y(n);tt(r,()=>e.children??ge),E(t,n)}var Kc=R("<!> <!>",1),Zc=R("<!> <!> <!>",1),Jc=R('<div class="timeline-view--timeline svelte-ikcfft"><!> <!> <!></div>');function $c(t,e){ne(e,!0);const[n,r]=Er(),i=()=>Mt(h,"$persistedValuePerPixel",n),o=()=>Mt(I,"$scale",n),a=()=>Mt(d,"$focalValue",n),u=()=>Mt(F,"$settingsOpen",n),l=()=>Mt(Me,"$mode",n),c=()=>Mt(ie,"$groupsSectionCollapsed",n),d=e.namespacedWritable.make("focalValue",0),h=e.namespacedWritable.make("scale",1);let f=V(null);const p=M(()=>s(f)?.fitBounds());function v(O=new mt(1)){function G(ke){const Ie=ke.toValue(1),S=1/100;return Number.isNaN(Ie)?new mt(S):new mt(Math.max(S,Ie))}const{subscribe:Pe,set:Te}=xr(G(O));return{subscribe:Pe,set:ke=>{const Ie=G(ke);return Te(Ie),Rt(h,Ie.valuePerPixel),Ie}}}const g=M(()=>e.items.map(jc)),b=M(()=>{const O=s(g),G=e.selectValue,Pe=e.selectLength;return O.forEach(Te=>{let ke=G(Te.source),Ie=Pe(Te.source);Ie<0&&(ke=ke+Ie,Ie=-Ie),ve(()=>{Te.setStartValue(ke),Te.setLength(Ie)})}),{items:O,_:Math.random()}});async function w(O){await e.onItemsResized(O.map(G=>{let Pe=G.value,Te=G.length,ke=G.endValue;return e.selectLength(G.item.source)<0&&(Te=-Te,Pe=ke,ke=G.value),{item:G.item.source,value:Pe,length:Te,endValue:ke}})),O.forEach(G=>G.item.setStartValue(G.value)),O.forEach(G=>G.item.setLength(G.length))}const x=M(()=>({items:s(b).items.sort((O,G)=>{const Pe=O.startValue()-G.startValue();return Pe!==0?Pe:G.length()-O.length()}),_:Math.random()})),I=v(new mt(i()));Oe(()=>{Rt(I,new mt(i()))});const P=fu(I,{get(){return s(x).items}},O=>{const G=O(a());G!=a()&&Rt(d,G)},()=>s(p));let _=V(!1);function D(){X?P.zoomToFit(s(g),s(p)):y(_,!0)}Oe(()=>{s(_)&&s(p)==null&&(y(_,!1),P.zoomToFit(s(g),s(p)))});function q(){}function B(O){s(f)?.focusOnId(O)}function le(){}let X=!1;Oe(()=>{X||s(p)!=null&&(X=!0)});let H=V(void 0);function ue(){return s(H)?.minValueStep()??0}let we=V(0);const Me=e.namespacedWritable?.make("mode","edit"),F=e.namespacedWritable.namespace("settings").make("isOpen",!1),Q=new Yc(!u());Q.onChange=()=>{Rt(F,!Q.isCollapsed())};const ie=e.namespacedWritable.namespace("settings").namespace("groups").make("collapsed",!0);function j(){e.openDialog(O=>{O.modalEl.addClass("timeline-help"),O.titleEl.setText("Timeline Help");const G=tn(Uc,{target:O.contentEl,props:{}});return()=>gi(G)})}var he=Jc(),Le=Y(he);De(Vu(Le,{get displayType(){return e.rulerDisplayType},get scale(){return o()},get focalValue(){return a()},get clientHeight(){return s(we)},set clientHeight(O){y(we,C(O))}}),O=>y(H,C(O)),()=>s(H));var Ue=A(Le,2);const Ne=M(()=>Me!=null?l()==="edit":!1),Dt=M(()=>e.oncontextmenu?(O,G)=>{e.oncontextmenu(O,G.map(Pe=>Pe.source))}:void 0);De(hc(Ue,{previewItem:(O,G,Pe,Te,ke)=>e.selectLength(O.source)<0?e.previewItem(G,ke,-Te,Pe):e.previewItem(G,Pe,Te,ke),summarizeItem:O=>e.summarizeItem(O.source),get sortedItems(){return s(x).items},get scale(){return o()},get focalValue(){return a()},get editable(){return s(Ne)},get itemsResizable(){return e.itemsResizable},onItemsChanged:w,onPreviewNewItemValue:(O,G)=>e.onPreviewNewItemValue(O.source,G),get oncontextmenu(){return s(Dt)},$$events:{scrollToValue:O=>P.scrollToValue(O.detail),scrollX:({detail:O})=>P.scrollToValue(a()+O),zoomIn:({detail:O})=>P.zoomIn(O),zoomOut:({detail:O})=>P.zoomOut(O),select:({detail:O})=>e.onSelected(O.item.source,O.causedBy),focus:({detail:O})=>e.onFocused(O.source),create:({detail:O})=>e.onCreate(O.value,O.cause)}}),O=>y(f,C(O)),()=>s(f));var $=A(Ue,2);Qc($,{children:(O,G)=>{var Pe=Zc(),Te=pe(Pe);yc(Te,{navigation:P});var ke=A(Te,2);bc(ke,{collapsable:Q,children:(S,T)=>{var L=Kc(),W=pe(L);tt(W,()=>e.additionalSettings);var se=A(W,2);zc(se,{get groups(){return e.groups},get pendingGroupUpdates(){return e.pendingGroupUpdates},get collapsed(){return bi(),c()},set collapsed(Z){Rt(ie,Z)}}),E(S,L)},$$slots:{default:!0}});var Ie=A(ke,2);Pi(Ie,{children:(S,T)=>{ut(S,{class:`clickable-icon ${hn}`,$$events:{action:j},children:(L,W)=>{Ke(L,{id:"help"})},$$slots:{default:!0}})}}),E(O,Pe)}}),te(O=>{Ce(he,"--ruler-height",`${s(we)??""}px`),Ce(he,"--plotarea-client-width",`${O??""}px`)},[()=>s(f)?.clientWidth()??0]),E(t,he);var Vn=re({zoomToFit:D,refresh:q,focusOnId:B,invalidateColors:le,minRulerStep:ue});return r(),Vn}var ef=R('<div><input type="checkbox" tabindex="0"></div>');function tf(t,e){let n=U(e,"class",3,""),r=U(e,"tabindex",3,0),i=U(e,"disabled",3,!1),o=U(e,"checked",15,!1);var a=ef(),u=Y(a);te(()=>{lt(a,`checkbox-container ${(o()?"is-enabled":"")??""} ${n()??""} svelte-5h2myb`),J(a,"tabindex",r()),Ft(a,"disabled",i()),u.disabled=i()}),ql(u,()=>o(),l=>{i()||o(l)}),E(t,a)}var nf=R("<label> <!></label>");function Eo(t,e){let n=U(e,"checked",15,!1),r=U(e,"class",3,""),i=U(e,"disabled",3,!1),o=U(e,"hint",3,""),a=U(e,"mod",3,void 0),u=U(e,"row",3,!1);var l=nf(),c=Y(l),d=A(c);tf(d,{get class(){return a()},get tabindex(){return e.tabindex},get disabled(){return i()},get checked(){return n()},set checked(h){n(h)}}),te(()=>{J(l,"aria-label",o()),lt(l,At(r()),"svelte-g24bva"),J(l,"aria-disabled",i()),Ft(l,"row",u()),Et(c,`${e.name??""} `)}),E(t,l)}function*ps(t){for(let e=0;e<t;e++)yield e}var rf=R("<option><!></option>"),sf=R('<dialog class="select-dropdown svelte-1tt3zkr"><ul role="listbox" class="svelte-1tt3zkr"></ul></dialog>'),of=R("<select></select> <!>",1);function Oo(t,e){ne(e,!0);const n=jt();let r=U(e,"selectedIndex",31,()=>-1),i=U(e,"itemCount",3,0),o=$n(e,["$$slots","$$events","$$legacy","selectedIndex","itemCount","item"]),{"aria-disabled":a}=o,u=V(!1),l=V(void 0),c;function d(F){!a&&!s(u)&&i()>0&&n("showing",F,{cancelable:!0})&&(s(l)!=null&&(c=s(l).getBoundingClientRect()),y(u,!0),n("shown",F))}function h(F){!a&&s(u)&&n("hiding",F,{cancelable:!0})&&(y(u,!1),n("hidden",F))}function f(F){s(u)?h(F):d(F)}function p(F,Q){r(F),n("changed",F,{cancelable:!0})&&Q()}function v(F){n("changing",F,{cancelable:!0})&&g(F)}function g(F){p(F,()=>h())}Ja("change",v);let b=V(void 0);function w(){return s(u)?s(b):void 0}tu(()=>{s(b)!=null&&s(b).parentElement?.removeChild(s(b))});function x(F){F.parentElement!=document.body&&document.body.appendChild(F);const{width:Q,height:ie}=window.visualViewport,j=F.getBoundingClientRect();c!=null?F.setCssStyles({left:`${Math.min(c.x,Q-j.width)}px`,top:`${Math.min(c.y+c.height,ie-j.height)}px`,width:c.width>j.width?`${c.width}px`:void 0}):F.setCssStyles({left:`${Math.max(0,(Q-j.width)/2)}px`,top:`${Math.max(0,(ie-j.height)/2)}px`})}function I(F){if(s(b)==null)return;const Q=F.relatedTarget;Q==null||!(Q instanceof Node)||!P(Q,s(b))?h():s(l)!=null&&s(l).focus()}function P(F,Q){let ie=F;for(;ie!=null;){if(ie==Q)return!0;ie=ie.parentElement}return!1}const _="select-dropdown-"+Math.random().toString(36).slice(2);function D(F){F.preventDefault(),f()}Hn(()=>{s(u)&&s(b)!=null&&x(s(b))});var q=of(),B=pe(q),le=F=>{F.stopPropagation(),F.preventDefault(),F.currentTarget.focus(),D(F)},X=F=>{F.key==="Enter"?D(F):F.key==="Escape"?(h(),F.preventDefault(),F.stopPropagation()):F.key==="ArrowUp"?s(u)&&(p(Math.max(0,r()-1),()=>{}),F.preventDefault()):F.key==="ArrowDown"&&s(u)&&(p(Math.min(i()-1,r()+1),()=>{}),F.preventDefault())},H=F=>g(F.currentTarget.selectedIndex);let ue;bo(B,()=>ue.value),Ut(B,21,()=>ps(i()),Ht,(F,Q)=>{var ie=rf(),j={},he=Y(ie);tt(he,()=>e.item??ge,()=>({index:s(Q),select:v})),te(()=>{j!==(j=s(Q))&&(ie.value=(ie.__value=s(Q))==null?"":s(Q)),vo(ie,r()===s(Q))}),E(F,ie)}),De(B,F=>y(l,F),()=>s(l));var we=A(B,2);{var Me=F=>{var Q=sf();J(Q,"id",_);var ie=Y(Q);Ut(ie,21,()=>ps(i()),Ht,(j,he)=>{var Le=ze(),Ue=pe(Le),Ne=_n(()=>({index:s(he),select:v.bind(null,s(he))}));tt(Ue,()=>e.item??ge,()=>s(Ne)),E(j,Le)}),De(Q,j=>y(b,j),()=>s(b)),te(()=>{Q.open=s(u),J(Q,"data-popupfor",e.id)}),E(F,Q)};xe(we,F=>{s(u)&&F(Me)})}return te(()=>{ue=Nr(B,ue,{...o,onmousedown:le,onkeydown:X,onfocusout:I,onchange:H,role:"combobox","aria-expanded":s(u),"aria-owns":_,"aria-controls":_,value:r()},"svelte-1tt3zkr"),"value"in ue&&_r(B,ue.value),Ft(B,"dropdown",!0)}),E(t,q),re({show:d,hide:h,toggleShown:f,change:v,getDialog:w})}var ur=(t=>(t.Number="number",t.Date="date",t.DateTime="datetime",t))(ur||{});function vs(t){switch(t){case"number":return"number";case"date":return"date";case"datetime":return"datetime"}return null}class K{constructor(e,n,r){this.name=e,this.#e.v=C(n),this.#n.v=C(r),n==="number"&&(this.#i.v=C(this.#r))}#e=V("number");type(){return s(this.#e)}#t(e){y(this.#e,C(e)),e==="number"?y(this.#i,C(this.#r)):y(this.#i,null)}#n=V(!0);usesInts(){return s(this.#e)!=="number"||s(this.#n)}prefersInts(){return s(this.#n)}#r(e){y(this.#n,C(e))}#i=V(null);get useInts(){return s(this.#i)}static setType(e,n){e===K.Created||e===K.Modified||e.#t(n)}displayedAs(){return s(this.#e)==="number"?Pn.Numeric:Pn.Date}valueOrNull(e){if(this===K.Created)return e.created;if(this===K.Modified)return e.modified;const n=e.properties[this.name];if(n==null)return null;if(typeof n=="number")return n;if(typeof n=="string"){const r=window.moment(n);if(r.isValid())return r.valueOf();const i=parseFloat(n);return isNaN(i)?null:i}return null}sanitizeValue(e){return this.usesInts()?Math.round(e):e}createItem(e){return this===K.Created?{created:e}:this===K.Modified?{modified:e}:{properties:{[this.name]:this.sanitizeValue(e)}}}static Number(e,n){return new K(e,"number",n)}static Date(e,n){return new K(e,"date",n)}static DateTime(e,n){return new K(e,"datetime",n)}static Created=K.DateTime("created",!0);static Modified=K.DateTime("modified",!0)}class ki{constructor(e,n,r,i,o,a){this.refresh=e,this.properties=n,this.#e.v=C(r),this.#t.v=C(i),this.#n.v=C(o),this.#r.v=C(a)}#e=V(C(K.Created));primary(){return s(this.#e)}onPrimaryPropertyChanged=null;setPrimaryProperty(e){y(this.#e,C(e)),this.onPrimaryPropertyChanged?.()}#t=V(C(K.Modified));#n=V("length");#r=V(!1);enableSecondaryProperty(e=!0){y(this.#r,C(e))}disableSecondaryProperty(e=!0){y(this.#r,!e)}secondary(){return s(this.#r)?{property:()=>s(this.#t),setProperty:e=>{y(this.#t,C(e))},interpretedAs:()=>s(this.#n),interpretAs:e=>{y(this.#n,C(e))}}:null}async options(){const e=ve(()=>s(this.#e)),n=ve(()=>s(this.#t));for(const r of await this.refresh()){const i=r.name(),o=vs(r.type()),a=this.properties.findIndex(u=>u.name===r.name());if(a>=0){const u=this.properties[a];o===null?(this.properties.splice(a,1),e===u&&y(this.#e,C(K.Created)),n===u&&y(this.#t,C(K.Modified))):K.setType(u,o)}else{if(o===null)continue;o==="number"?this.properties.push(K.Number(i,!0)):o==="date"?this.properties.push(K.Date(i,!0)):this.properties.push(K.DateTime(i,!0))}}return this.properties}saveState(){const e={};for(const n of this.properties)n===K.Created||n===K.Modified||n.prefersInts()||(e[n.name]=!1);return{property:s(this.#e).name,propertiesUseWholeNumbers:e,secondaryProperty:{name:s(this.#t).name,inUse:s(this.#r),useAs:s(this.#n)}}}createItem(e){return s(this.#e).createItem(e)}static async make(e,n,r,i){const o=[K.Created,K.Modified];for(const l of await e()){const c=l.name(),d=r[c]??!0,h=vs(l.type());let f;switch(h){case"number":f=K.Number(c,d);break;case"date":f=K.Date(c,d);break;case"datetime":f=K.DateTime(c,d);break;default:console.warn(`[Timeline View] Unknown property type: ${h}`);continue}o.push(f)}const a=o.find(l=>l.name===n)??K.Created,u=o.find(l=>l.name===i.name)??K.Modified;return new ki(e,o,a,u,i.useAs,i.inUse)}}function Fo(t){Ke(t,{id:"clock"})}function Do(t){Ke(t,{id:"calendar"})}function Lo(t){Ke(t,{id:"binary"})}var af=R('<div class="suggestion-item mod-complex" role="option"><div class="suggestion-icon"><span class="suggestion-flair"><!></span></div> <div class="suggestion-content"><div class="suggestion-title"><!></div></div></div>');function Ao(t,e){var n=af();n.__focusin=function(...c){e.onfocusin?.apply(this,c)},n.__click=function(...c){e.onclick?.apply(this,c)},n.__keydown=function(...c){e.onkeydown?.apply(this,c)};var r=Y(n),i=Y(r),o=Y(i);tt(o,()=>e.icon??ge);var a=A(r,2),u=Y(a),l=Y(u);tt(l,()=>e.children??ge),te(()=>{J(n,"aria-selected",e.selected),J(n,"tabindex",e.tabindex),Ft(n,"is-selected",e.selected)}),Bt("mouseenter",n,function(...c){e.onmouseenter?.apply(this,c)}),E(t,n)}ln(["focusin","click","keydown"]);function lf(t,e){ne(e,!0);const n=zs("change");function r(){(!e.onSelect||e.onSelect(e.index)!==!1)&&n?.(e.index)}const i=M(()=>e.onConsidered?()=>e.onConsidered(e.index):void 0);Ao(t,{get selected(){return e.selected},get tabindex(){return e.index},get onmouseenter(){return s(i)},get onfocusin(){return s(i)},onclick:r,onkeydown:a=>a.key==="Enter"?r():null,icon:a=>{var u=ze(),l=pe(u);{var c=h=>{Fo(h)},d=h=>{var f=ze(),p=pe(f);{var v=b=>{Do(b)},g=b=>{var w=ze(),x=pe(w);{var I=P=>{Lo(P)};xe(x,P=>{e.type===ur.Number&&P(I)},!0)}E(b,w)};xe(p,b=>{e.type===ur.Date?b(v):b(g,!1)},!0)}E(h,f)};xe(l,h=>{e.type===ur.DateTime?h(c):h(d,!1)})}E(a,u)},children:(a,u)=>{var l=vi();te(()=>Et(l,e.name)),E(a,l)}}),re()}function gs(t,e){ne(e,!0);let n=V(C(e.property.name)),r=V(C(e.alwaysAvailableProperties)),i=M(()=>s(r).map(v=>v.name)),o=M(()=>s(r).length),a=V(-1),u=V(-1);function l(v){y(n,C(s(i)[v])),y(u,C(v)),y(a,-1);const g=s(r)[v];e.onSelected(g)}function c(v){l(v.detail)}function d(v){y(a,C(v))}function h(v){return s(r)[v].type()}async function f(){const v=await e.getProperties();y(r,C(v)),y(u,C(v.findIndex(g=>g.name===s(n)))),s(u)===-1&&l(0)}function p(){this.getDialog()?.classList.add("timeline-property-select-popup")}rn(()=>{f()}),Oo(t,{class:"timeline-property-select",get tabindex(){return e.tabindex},get selectedIndex(){return s(u)},get itemCount(){return s(o)},$$events:{changed:c,showing:f,shown:p},item:(g,b)=>{let w=()=>b?.().index;const x=M(()=>s(u)===w()||s(a)===w()),I=M(()=>h(w()));lf(g,{get index(){return w()},get selected(){return s(x)},get name(){return s(i)[w()]},get type(){return s(I)},onConsidered:d})},$$slots:{item:!0}}),re()}const ys=(t,e=ge,n=ge)=>{var r=()=>n().usesInts(),i=a=>n().useInts?.(a);const o=M(()=>n().useInts===null);Eo(t,{class:"numeric-property-int-toggle",row:!0,name:"Use whole numbers",hint:"When creating a new note, or making modifications, round to the nearest whole number for this property value",get tabindex(){return e()},mod:"mod-small",get checked(){return r()},set checked(a){i(a)},get disabled(){return s(o)}})};var uf=R('<span class="warning svelte-kdh09g">These properties have different types and may be nonsensical.</span>'),cf=R('<!> <!> <!> <label class="svelte-kdh09g">Interpret as <select class="dropdown"><option>Length</option><option>End</option></select></label>',1),ff=R('<section class="svelte-kdh09g"><h6 class="svelte-kdh09g">Order by</h6> <!> <!> <!></section> <section class="svelte-kdh09g"><h6 class="svelte-kdh09g"><!></h6> <!></section>',1);function df(t,e){ne(e,!0);const[n,r]=Er(),i=()=>Mt(e.collapsed,"$collapsed",n),o=l=>{var c=ze(),d=pe(c);{var h=f=>{var p=uf();E(f,p)};xe(d,f=>{s(u)&&f(h)})}E(l,c)},a=M(()=>e.properties.secondary()),u=M(()=>{if(s(a)===null)return!1;const l=e.properties.primary().type(),c=s(a).property().type();return l==="number"&&c!=="number"||l!=="number"&&c==="number"});Ti(t,{name:"Properties",class:"timeline-property-setting",get collapsed(){return bi(),i()},set collapsed(l){Rt(e.collapsed,l)},children:(l,c)=>{var d=ff(),h=pe(d),f=A(Y(h),2);o(f);var p=A(f,2);const v=M(()=>[K.Created,K.Modified]),g=M(()=>e.properties.primary()),b=M(()=>e.properties.setPrimaryProperty.bind(e.properties));gs(p,{tabindex:0,get alwaysAvailableProperties(){return s(v)},get property(){return s(g)},getProperties:()=>e.properties.options(),get onSelected(){return s(b)}});var w=A(p,2),x=_n(()=>e.properties.primary());ys(w,()=>1,()=>s(x));var I=A(h,2),P=Y(I),_=Y(P),D=()=>s(a)!==null,q=e.properties.enableSecondaryProperty.bind(e.properties);Eo(_,{row:!0,mod:"mod-small",tabindex:2,name:"Secondary Property",get checked(){return D()},set checked(X){q(X)}});var B=A(P,2);{var le=X=>{var H=cf(),ue=pe(H);o(ue);var we=A(ue,2);const Me=M(()=>[K.Created,K.Modified]),F=M(()=>s(a).property()),Q=M(()=>s(a).setProperty.bind(s(a)));gs(we,{tabindex:0,get alwaysAvailableProperties(){return s(Me)},get property(){return s(F)},getProperties:()=>e.properties.options(),get onSelected(){return s(Q)}});var ie=A(we,2),j=_n(()=>s(a).property());ys(ie,()=>4,()=>s(j));var he=A(ie,2),Le=A(Y(he)),Ue=Y(Le);Ue.value=(Ue.__value="length")==null?"":"length";var Ne=A(Ue);Ne.value=(Ne.__value="end")==null?"":"end",Hl(Le,()=>s(a).interpretedAs(),s(a).interpretAs.bind(s(a))),E(X,H)};xe(B,X=>{s(a)!==null&&X(le)})}E(l,d)},$$slots:{default:!0}}),re(),r()}var hf=(t,e)=>t.key==="Enter"&&e(),mf=R('<div class="svelte-1nwhmyd"><div class="search-input-container svelte-1nwhmyd"><input> <div class="search-input-clear-button svelte-1nwhmyd" aria-label="Clear search"></div></div></div>');function pf(t,e){let n=U(e,"value",15),r=$n(e,["$$slots","$$events","$$legacy","value","isLoading"]);function i(){n("")}var o=mf(),a=Y(o),u=Y(a);let l;var c=A(u,2);c.__click=i,c.__keydown=[hf,i],te(()=>{J(o,"aria-busy",e.isLoading),Ft(o,"is-loading",e.isLoading),l=Nr(u,l,{type:"search",enterkeyhint:"search",spellcheck:"false",...r},"svelte-1nwhmyd")}),yi(u,n),E(t,o)}ln(["click","keydown"]);function Ro(t,e){ne(e,!0);let n=U(e,"filtering",3,!1),r=V(C(e.filter.query()));Hn(()=>{s(r)!=e.filter.query()&&(e.filter.filterByQuery(s(r)),y(r,C(e.filter.query())))});const i=M(()=>n()||void 0);pf(t,{placeholder:"Search files...",get isLoading(){return s(i)},get value(){return s(r)},set value(o){y(r,C(o))}}),re()}function vf(t,e){const[n,r]=Er(),i=()=>Mt(e.collapsed,"$collapsed",n);Ti(t,{name:"Filter",get collapsed(){return bi(),i()},set collapsed(o){Rt(e.collapsed,o)},children:(o,a)=>{Ro(o,{get filter(){return e.filter},get filtering(){return e.filtering}})},$$slots:{default:!0}}),r()}class Wo{constructor(e,n,r){this.#t=e,this.#n=r,this.#e=e.getInclusiveNoteFilterForQuery(n)}#e;noteFilter(){return this.#e}query(){return this.#e.query()}#t;#n;#r=null;filterByQuery(e){this.#e=this.#t.getInclusiveNoteFilterForQuery(e),this.#r?(clearTimeout(this.#r),this.#r=setTimeout(()=>{this.#n(e),this.#r=null},350)):this.#n(e)}}class gf{#e=[];constructor(e){this.#e=e}get items(){return this.#e}get length(){return this.#e.length}[Symbol.iterator](){return this.#e[Symbol.iterator]()}}class gn{#e;#t;constructor(e,n){this.#t=e,this.#e=n}static of(e,...n){return new gn(e,n.sort((r,i)=>e(r)-e(i)))}clone(){return new gn(this.#t,this.#e)}Readonly(){return new gf(this.#e.slice())}get items(){return this.#e}get length(){return this.#e.length}[Symbol.iterator](){return this.#e[Symbol.iterator]()}add(e){if(this.#e.length===0){this.#e.push(e);return}const n=this.#t(e);if(this.#e.length===1){this.#t(this.#e[0])>n?this.#e.unshift(e):this.#e.push(e);return}const r=(o,a)=>{if(a<=o)return o;const u=o+a>>1,l=this.#t(this.#e[u]);return l===n?u:l>n?r(o,u):r(u+1,a)},i=r(0,this.#e.length);this.#e.splice(i,0,e)}remove(e){if(this.#e.length===0)return;const n=this.#t(e),r=(o,a)=>{if(a<o)return-1;const u=o+a>>1;if(u<0||u>=this.#e.length)return-1;const l=this.#t(this.#e[u]);if(l===n){let c=u;do{if(this.#e[c]===e)return c;c=c-1}while(c>=0&&this.#t(this.#e[c])===n);let d=u+1;for(;d<this.#e.length&&this.#t(this.#e[d])===n;){if(this.#e[d]===e)return d;d++}return-1}return l>n?r(o,u-1):r(u+1,a)},i=r(0,this.#e.length);i>=0&&this.#e.splice(i,1)}}class Wn{constructor(e,n){this.onBatchStart=e,this.continueBatch=n}static new(){let e=0;return new Wn(()=>{e=performance.now()+16},()=>e>=performance.now())}tasks=[];#e=!1;enqueue(e){this.cancelled||(this.tasks.push(e),this.#e||(this.#e=!0,this.#r()))}#t=new Set;onProgress(e){e(this.tasks.length),this.#t.add(e)}#n=new Set;onFinished(e){this.#n.add(e)}cancelled=!1;cancel(){this.cancelled=!0}async#r(e=Promise.resolve()){if(this.cancelled){this.tasks.length>0&&this.#n.forEach(i=>i(!0));return}this.onBatchStart(),await e;const n=[];let r=this.tasks.shift();for(;r&&this.continueBatch();)n.push(r()),r=this.tasks.shift();this.#t.forEach(i=>i(this.tasks.length)),n.length>0?setTimeout(()=>this.#r(Promise.all(n)),0):(this.#e=!1,this.#n.forEach(i=>i(!1)))}}function yf(t,e){return t.includes(e)}function wf(t,e){return yf(t,e.type())}const Ci=["number","date","datetime"];function bf(t){return wf(Ci,t)}var zt=(t=>(t[t.Number=0]="Number",t[t.Date=1]="Date",t[t.DateTime=2]="DateTime",t))(zt||{});function ws(t){switch(t){case"number":return 0;case"date":return 1;case"datetime":return 2}}class bs{constructor(e){this.property=e}selectValueFromNote(e){const n=e.properties();if(!(this.property.name()in n))return null;const r=e.properties()[this.property.name()];if(typeof r=="number")return r;if(typeof r=="string"){const i=window.moment(r);if(i.isValid())return i.valueOf();const o=parseFloat(r);return isNaN(o)?null:o}return null}}class Se{static fromNoteProperty(e){return new Se(e.name(),ws(e.type()),new bs(e))}static update(e,n){e===Se.Created||e===Se.Modified||(e.#e=n.name(),e.#t=ws(n.type()),e.#n=new bs(n))}constructor(e,n,r){this.#e=e,this.#t=n,this.#n=r}#e;name(){return this.#e}#t;type(){return this.#t}#n;sortNotes(e){e.sort((n,r)=>(this.#n.selectValueFromNote(n)??0)-(this.#n.selectValueFromNote(r)??0))}selectValueFromNote(e){return this.#n.selectValueFromNote(e)}static Created=new Se("created",2,{selectValueFromNote(e){return e.created()}});static Modified=new Se("modified",2,{selectValueFromNote(e){return e.modified()}})}var _f=R("<!> <!>",1);function xf(t,e){ne(e,!0);const[n,r]=Er(),i=()=>Mt(v,"$filterQuery",n);class o{#e=V(0);get created(){return s(this.#e)}set created(T){y(this.#e,C(T))}#t=V(0);get modified(){return s(this.#t)}set modified(T){y(this.#t,C(T))}#n=V(C({}));get properties(){return s(this.#n)}set properties(T){y(this.#n,C(T))}#r=V(null);get group(){return s(this.#r)}set group(T){y(this.#r,C(T))}get id(){return s(this.#i).id()}#i=V(null);get note(){return s(this.#i)}#s=V("");name(){return s(this.#s)}color(){return this.group?.color()}constructor(T){this.#i.v=C(T),this.replaceNote(T)}replaceNote(T){y(this.#i,C(T)),y(this.#s,C(T.name())),this.created=T.created(),this.modified=T.modified(),this.properties=T.properties()}}let a=U(e,"isNew",3,!1),u=U(e,"oncontextmenu",3,()=>{}),l=U(e,"onResizeNotes",3,async()=>{});const c=jt(),d=e.viewModel.namespace("settings");let h=new Map,f=V(gn.of(q)),p=0;const v=d.namespace("filter").make("query","");let g=V(!1),b=new Wo(e.noteRepository,i(),async S=>{v.set(S);const T=p+1;p=T;const L=[],W=Wn.new();y(g,!0);for(const se of h.values())W.enqueue(async()=>{await b.noteFilter().matches(se.note)&&L.push(se)});W.onProgress(()=>{if(p!==T){W.cancel();return}y(f,gn.of(q,...L))}),W.onFinished(se=>{se||y(g,!1)})});const w=d.namespace("groups").make("groups",[]),x=new Vo(It(w).map(Tn.fromSavedState));Oe(()=>{Rt(w,x.saveState())});function I(S,T){c("noteSelected",{note:T.note,event:S})}const P=d.namespace("property");let _=V(null);rn(async()=>{y(_,C(await ki.make(e.notePropertyRepository.listPropertiesOfTypes.bind(e.notePropertyRepository,Ci),It(P.make("property","created")),It(P.make("propertiesUseWholeNumbers",{})),{name:It(P.namespace("secondaryProperty").make("name","modified")),useAs:It(P.namespace("secondaryProperty").make("useAs","end")),inUse:It(P.namespace("secondaryProperty").make("inUse",!1))})))}),Oe(()=>{if(s(_)===null)return;const S=s(_).saveState();P.make("property","created").set(S.property),P.make("propertiesUseWholeNumbers",{}).set(S.propertiesUseWholeNumbers);const T=P.namespace("secondaryProperty");T.make("name","modified").set(S.secondaryProperty.name),T.make("inUse",!1).set(S.secondaryProperty.inUse),T.make("useAs","end").set(S.secondaryProperty.useAs)});const D=M(()=>{if(s(_)===null)return()=>0;const S=s(_).primary();return T=>S.valueOrNull(T)});function q(S){return s(D)(S)??0}async function B(S,T){s(_)!==null&&await e.onCreateNote(s(_).createItem(S.value),T)}async function le(S){if(s(_)===null)return;const T=s(_).primary(),L=s(_).secondary();if(L===null)return;const W=new Array;function se(Z,be,oe){oe=be.sanitizeValue(oe),be===K.Created?Z.created=oe:be===K.Modified?Z.modified=oe:Z.properties[be.name]=oe}for(let Z=0;Z<S.length;Z++){const{value:be,length:oe,endValue:nt}=S[Z],rt=h.get(S[Z].item.id);if(!rt)continue;const Gt={note:rt.note,item:rt,created:void 0,modified:void 0,properties:{}};se(Gt,T,be),L.interpretedAs()==="end"?se(Gt,L.property(),nt):se(Gt,L.property(),oe),W.push(Gt)}await l()(W);for(let Z=0;Z<W.length;Z++)Object.assign(W[Z].item.properties,W[Z].properties)}let X=V(void 0);const H=M(()=>(s(_)?.primary()??K.Created).displayedAs()),ue=M(()=>s(X)?.minRulerStep()??0),we=M(()=>{const S=s(H);return T=>ei(S,0,T)}),Me=M(()=>{const S=s(H),T=s(ue);return S===Pn.Numeric?L=>wu(L):L=>bu(L,T)});rn(async()=>{for(const T of e.noteRepository.listAll()){const L=new o(T);h.set(T.id(),L)}const S=[];for(let T of h.values())await b.noteFilter().matches(T.note)&&S.push(T);y(f,gn.of(q,...S)),a()&&ns().then(()=>{s(X)?.zoomToFit()})});const F=(()=>{const S=Wn.new();return S.onProgress(()=>{y(f,ve(()=>s(f).clone()))}),T=>{S.enqueue(T)}})();let Q=V(0);Oe(()=>{const S=x.list();if(S.length===0){for(const W of s(f))W.group=null;return}const T=S.map(W=>e.noteRepository.getExclusiveNoteFilterForQuery(W.query()));let L=Wn.new();for(const W of s(f))Oe(()=>{const se=W.note;L?.enqueue(async()=>{W.group=null;for(let Z=0;Z<S.length;Z++)if(S[Z].query()!==""&&await T[Z].matches(se)){W.group=S[Z];break}})});return L.onProgress(W=>{y(Q,C(W))}),()=>{L?.cancel(),L=null}});const ie=M(()=>{if(s(_)===null)return()=>0;const S=s(_).secondary();if(S===null)return()=>0;const T=S.property();if(S.interpretedAs()==="length")return L=>T.valueOrNull(L)??0;{const L=s(_).primary();return W=>{const se=L.valueOrNull(W)??0;return(T.valueOrNull(W)??se)-se}}});function j(S){if(s(_)===null)return"";const T=s(_).primary(),L=T.valueOrNull({created:S.created(),modified:S.modified(),properties:S.properties()}),W=L===null?"":s(we)(L),se=s(_).secondary();if(se===null)return`${S.name()}
[${T.name}: ${W}]`;const Z=se.property(),be=Z.valueOrNull({created:S.created(),modified:S.modified(),properties:S.properties()});if(se.interpretedAs()==="end"){const rt=be===null?"":s(we)(be),Nn=(be??L??0)-(L??0);return`${S.name()}
[${T.name}: ${W}]  [${Z.name}: ${rt}]
length: ${s(Me)(Nn)}`}const oe=(L??0)+(be??L??0),nt=be===null?"":s(Me)(be);return`${S.name()}
[${T.name}: ${W}]  ${s(we)(oe)}
[${Z.name}: ${nt}]`}function he(S,T,L,W){if(s(_)===null)return"";const se=s(_).primary();T=se.sanitizeValue(T);const Z=s(we)(T),be=s(_).secondary();if(be===null)return`${S}
[${se.name}: ${Z}]`;const oe=be.property();be.interpretedAs()==="length"?(L=oe.sanitizeValue(L),W=T+L):(W=oe.sanitizeValue(W),L=W-T);const nt=s(Me)(L),rt=s(we)(W);return be.interpretedAs()==="end"?`${S}
[${se.name}: ${Z}]  [${oe.name}: ${rt}]
length: ${nt}`:`${S}
[${se.name}: ${Z}]  ${rt}
[${oe.name}: ${nt}]`}async function Le(S){if(s(X)==null||h.has(S.id()))return;const T=new o(S);h.set(S.id(),T),await b.noteFilter().matches(T.note)&&F(()=>{s(f).add(T)})}function Ue(S){if(s(X)==null)return;const T=h.get(S.id());T!=null&&h.delete(S.id())&&F(()=>s(f).remove(T))}async function Ne(S){if(s(X)==null)return;const T=h.get(S.id());if(T==null)return;const L=await b.noteFilter().matches(S);F(()=>{T.replaceNote(S),L||s(f).remove(T)})}async function Dt(S,T){if(s(X)==null)return;const L=h.get(T);if(L==null)return;h.delete(T),h.set(S.id(),L);const W=await b.noteFilter().matches(S);F(()=>{L.replaceNote(S),W||s(f).add(L)})}function $(S){h.get(S.id())!=null&&s(X)?.focusOnId(S.id())}function Vn(){s(X)?.zoomToFit()}Oe(()=>{s(_)!==null&&(s(_).onPrimaryPropertyChanged=()=>{y(f,ve(()=>s(f).clone())),ns().then(()=>{s(X)?.zoomToFit()})})});function O(S,T){return s(_)===null?T:s(_).primary().sanitizeValue(T)}const G=M(()=>{if(s(_)===null)return()=>null;const S=s(_).primary();return S.valueOrNull.bind(S)}),Pe=M(()=>{const S=s(G);return T=>S(T)??0}),Te=M(()=>Array.from(s(f))),ke=M(()=>s(_)?.secondary()!==null);De($c(t,{get items(){return s(Te)},get selectValue(){return s(Pe)},get selectLength(){return s(ie)},previewItem:(T,L,W,se)=>he(T,L,W,se),summarizeItem:T=>j(T.note),get itemsResizable(){return s(ke)},get namespacedWritable(){return e.viewModel},get rulerDisplayType(){return s(H)},groups:x,get pendingGroupUpdates(){return s(Q)},controlBindings:{},onSelected:(T,L)=>I(L,T),onFocused:T=>c("noteFocused",T.note),onCreate:(T,L)=>B({value:T},L),onItemsResized:le,onPreviewNewItemValue:O,oncontextmenu:(T,L)=>{u()(T,L.map(W=>W.note))},get openDialog(){return e.openModal},additionalSettings:T=>{var L=_f(),W=pe(L);{var se=oe=>{const nt=M(()=>d.namespace("property").make("collapsed",!0));df(oe,{get collapsed(){return s(nt)},get properties(){return s(_)}})};xe(W,oe=>{s(_)!==null&&oe(se)})}var Z=A(W,2);const be=M(()=>d.namespace("filter").make("collapsed",!0));vf(Z,{get collapsed(){return s(be)},filter:b,get filtering(){return s(g)}}),E(T,L)},$$slots:{additionalSettings:!0}}),T=>y(X,C(T)),()=>s(X));var Ie=re({addFile:Le,deleteFile:Ue,modifyFile:Ne,renameFile:Dt,focusOnNote:$,zoomToFit:Vn});return r(),Ie}function zo(t){return"setWarning"in t&&typeof t.setWarning=="function"&&t.setWarning(!0),t}function _s(t,e,n,r){const i=new de.Menu;i.addItem(o=>{o.setSection("open").setTitle("Open in new tab").setIcon("lucide-file-plus").onClick(()=>{n.openLinkText(e.path,"","tab")})}).addItem(o=>{o.setSection("open").setTitle("Open to the right").setIcon("lucide-separator-vertical").onClick(()=>{n.openLinkText(e.path,"","split")})}).addItem(o=>{o.setSection("open").setTitle("Open below").setIcon("lucide-separator-horizontal").onClick(()=>{n.getLeaf("split","horizontal").openFile(e)})}),n.trigger("file-menu",i,e,"timeline-view-context-menu"),i.addItem(o=>{zo(o).setSection("danger").setTitle("Delete").setIcon("lucide-trash-2").onClick(()=>{"promptForDeletion"in r&&typeof r.promptForDeletion=="function"?r.promptForDeletion(e):e.vault.delete(e)})}),i.showAtMouseEvent(t)}function Pf(t,e,n,r){const i=new de.Menu;n.trigger("files-menu",i,e,"timeline-view-context-menu"),i.addItem(o=>{zo(o).setSection("danger").setTitle("Delete").setIcon("lucide-trash-2").onClick(()=>{let a;"promptForDeletion"in r&&typeof r.promptForDeletion=="function"?a=r.promptForDeletion.bind(r):a=e[0].vault.delete.bind(e[0].vault);for(const u of e)a(u)})}),i.showAtMouseEvent(t)}function xs(t,e){return e instanceof MouseEvent||e instanceof KeyboardEvent?t.getLeaf(de.Keymap.isModEvent(e)):t.getLeaf(!0)}function Tf(t,e){new kf(t,e).open()}class kf extends de.Modal{constructor(e,n){super(e),this.callback=n}_clean(){}onOpen(){this._clean=this.callback(this)}onClose(){this._clean(),this.containerEl.empty()}}class Fe extends de.ItemView{constructor(e,n,r,i,o,a,u){super(e),this.workspace=i,this.fileManager=o,this.notes=a,this.noteProperties=u,this.navigation=!0,this.scope=new de.Scope(this.app.scope),this.scope.register(["Shift"]," ",()=>{this.component?.zoomToFit()}),this.initialization=new Promise(l=>{this.completeInitialization=l}),[n.on("create",l=>{l instanceof de.TFile&&this.component?.addFile(this.notes.getNoteForFile(l))}),n.on("rename",(l,c)=>{l instanceof de.TFile&&this.component?.renameFile(this.notes.getNoteForFile(l),c)}),r.on("changed",l=>{l instanceof de.TFile&&this.component?.modifyFile(this.notes.getNoteForFile(l))}),n.on("delete",l=>{l instanceof de.TFile&&this.component?.deleteFile(this.notes.getNoteForFile(l))}),this.workspace.on("active-leaf-change",l=>{if(l===this.leaf||!l||this.leaf.isDeferred)return;const c=l.getViewState().state;if(!c||!("file"in c)||typeof c.file!="string")return;const d=n.getAbstractFileByPath(c.file);d instanceof de.TFile&&this.showFile(d)})].forEach(l=>this.registerEvent(l))}static#e="waypoints";static get ICON(){return this.#e}getIcon(){return Fe.ICON}static#t="VIEW_TYPE_TIMELINE_VIEW";static get TYPE(){return this.#t}getViewType(){return Fe.TYPE}showFile(e){const n=this.notes.getNoteForFile(e);n&&this.component?.focusOnNote(n)}$mode="edit";mode=xr(this.$mode);onPaneMenu(e,n){super.onPaneMenu(e,n),e.addItem(r=>{r.setIcon("book-open").setChecked(this.$mode==="view").setSection("pane").setTitle("View-only timeline").onClick(()=>{this.mode.set(this.$mode==="view"?"edit":"view")})})}computeDisplayText(){const e=this.state?.settings?.property?.property??"",n=this.state?.settings?.property?.secondaryProperty,r=this.state?.settings?.filter?.query??"",i=`Timeline view [${e}] `,o=r!==""?` (filter: ${r})`:"";return n!=null&&n.inUse?n.useAs==="length"?`${i}[length: ${n.name}]`+o:`${i} [${n.name}]`+o:i+o}#n=this.computeDisplayText();get displayText(){return this.#n}set displayText(e){this.#n!==e&&(this.#n=e,iu(this)?.setText?.(e),su(this.leaf)?.updateHeader())}getDisplayText(){return this.displayText}component=null;initialization;completeInitialization(e){}state;setState(e,n){return this.state=Cf.parseOrDefault(e),this.displayText=this.computeDisplayText(),this.completeInitialization(this.state),super.setState(e,n)}#r(){return this.state!=null&&"isNew"in this.state&&delete this.state.isNew,this.state}getState(){return this.#r()??{}}async onOpen(){const e=this.contentEl;e.createEl("progress"),this.initialization?.then(n=>{delete this.initialization,e.empty(),e.setAttribute("style","padding:0;position: relative;overflow-x:hidden;overflow-y:hidden");const r=n.isNew,i=xo(n,(l,c)=>{n[l]=c,this.displayText=this.computeDisplayText(),this.workspace.requestSaveLayout()}),o=i.make("mode",this.$mode);It(o)==="edit"?this.mode.set("edit"):It(o)==="view"&&this.mode.set("view"),this.mode.subscribe(l=>o.set(l));const a=this.addAction("book-open",`Current view: editing
Click to view-only`,()=>this.mode.set("view")),u=this.addAction("edit-3",`Current view: view-only
Click to edit`,()=>this.mode.set("edit"));this.mode.subscribe(l=>{this.$mode=l,a.toggle(l==="edit"),u.toggle(l==="view")}),this.component=tn(xf,{target:e,props:{noteRepository:this.notes,notePropertyRepository:this.noteProperties,isNew:r,viewModel:i,oncontextmenu:(l,c)=>{if(c.length===1){const d=this.notes.getFileFromNote(c[0]);if(!d)return;_s(l,d,this.workspace,this.fileManager)}else if(c.length>1){const d=c.map(h=>this.notes.getFileFromNote(h)).filter(ri);if(d.length===0)return;d.length===1?_s(l,d[0],this.workspace,this.fileManager):Pf(l,d,this.workspace,this.fileManager)}},openModal:l=>{Tf(this.app,l)},onCreateNote:async(l,c)=>{const d=await this.notes.createNote(l),h=this.notes.getFileFromNote(d);return h&&setTimeout(()=>{xs(this.workspace,c).openFile(h)},250),d},onResizeNotes:async l=>{await Promise.all(l.map(c=>this.notes.modifyNote(c.note,c)))}},events:{noteSelected:l=>{const c=this.notes.getFileFromNote(l.detail.note);if(!c)return;const d=l.detail.event;xs(this.workspace,d).openFile(c)},noteFocused:l=>{}}})})}static closedState;static hasClosedState(){return!!this.closedState}static getPreviouslyClosedState(){return this.closedState}onClose(){return Fe.closedState=this.#r(),this.component!==null&&gi(this.component),super.onClose()}}var Yo=(t=>(t.View="view",t.Edit="edit",t))(Yo||{});const Cf=Xe({isNew:_c(at(!1)),focalValue:qr(0),vScroll:qr(0),mode:ti(Yo,"edit"),scale:qr(1),settings:Xe({isOpen:at(!1),property:Xe({collapsed:at(!0),property:Qe("created"),propertiesUseWholeNumbers:xc({key:Qe(""),value:at(!0)}),secondaryProperty:Xe({name:Qe("created"),inUse:at(!1),useAs:ti({length:"length",end:"end"},"length")})}),filter:Xe({collapsed:at(!0),query:Qe("")}),groups:Xe({collapsed:at(!0),groups:Io(Xe({query:Qe(""),color:Qe("")}))}),display:Xe({collapsed:at(!0),names:at(!1)})})});function Sf(t,e){ne(e,!0);const n=jt(),r=zs("change");function i(){n("select",e.index,{cancelable:!0})&&r?.(e.index)}Ao(t,{get selected(){return e.selected},get tabindex(){return e.index},onmouseenter:()=>n("consider",e.index),onfocusin:()=>n("consider",e.index),onclick:i,onkeydown:a=>a.key==="Enter"?i():null,icon:a=>{var u=ze(),l=pe(u);{var c=h=>{Fo(h)},d=h=>{var f=ze(),p=pe(f);{var v=b=>{Do(b)},g=b=>{var w=ze(),x=pe(w);{var I=P=>{Lo(P)};xe(x,P=>{e.type===zt.Number&&P(I)},!0)}E(b,w)};xe(p,b=>{e.type===zt.Date?b(v):b(g,!1)},!0)}E(h,f)};xe(l,h=>{e.type===zt.DateTime?h(c):h(d,!1)})}E(a,u)},children:(a,u)=>{var l=vi();te(()=>Et(l,e.name)),E(a,l)}}),re()}function Ps(t,e){ne(e,!0);const n=[Se.Created,Se.Modified];let r=V(C(e.property.name()));const i=jt();let o=V(C(n)),a=M(()=>s(o).map(b=>b.name())),u=M(()=>s(o).length),l=V(-1),c=V(-1);function d(b){y(r,C(s(a)[b])),y(c,C(b)),y(l,-1);const w=s(o)[b];i("selected",w)}function h(b){d(b.detail)}function f(b){y(l,C(b.detail))}function p(b){return s(o)[b].type()}async function v(){const b=await e.getProperties();y(o,C(b)),y(c,C(b.findIndex(w=>w.name()===s(r)))),s(c)===-1&&d(0)}function g(){this.getDialog()?.classList.add("timeline-property-select-popup")}rn(()=>{v()}),Oo(t,{class:"timeline-property-select",get tabindex(){return e.tabindex},get selectedIndex(){return s(c)},get itemCount(){return s(u)},$$events:{changed:h,showing:v,shown:g},item:(w,x)=>{let I=()=>x?.().index;const P=M(()=>s(c)===I()||s(l)===I()),_=M(()=>p(I()));Sf(w,{get index(){return I()},get selected(){return s(P)},get name(){return s(a)[I()]},get type(){return s(_)},$$events:{consider:f}})},$$slots:{item:!0}}),re()}async function Ts(t,e){if(t===Se.Created.name())return Se.Created;if(t===Se.Modified.name())return Se.Modified;const n=await e.getPropertyByName(t);return n==null||!bf(n)?Se.Created:Se.fromNoteProperty(n)}class Si{static async sanitize(e,n,r,i,o,a,u){const l=await Ts(e,i),c=await Ts(n,i);return new Si(l,c,r,i,o,a,u)}constructor(e,n,r,i,o,a,u){this.#e.v=C(e),this.#t.v=C(n),this.#i.v=C(r),this.#o=i,this.#n=o,this.#r=a,this.#s=u}#e=V(C(Se.Created));selectedProperty(){return s(this.#e)}#t=V(C(Se.Modified));secondaryProperty(){return s(this.#t)}#n;selectProperty(e){y(this.#e,C(e)),this.#n(e.name())}#r;selectSecondaryProperty(e){y(this.#t,C(e)),this.#r(e.name())}#i=V(!1);secondaryPropertyInUse(){return s(this.#i)}#s;toggleSecondaryProperty(e){y(this.#i,C(e)),this.#s(e)}#o;#a=new Map;#l(e){const n=this.#a.get(e.name());if(n)return Se.update(n,e),n;const r=Se.fromNoteProperty(e);return this.#a.set(e.name(),r),r}async availableProperties(){const e=await this.#o.listPropertiesOfTypes(Ci),n=[Se.Created,Se.Modified];for(const r of e)n.push(this.#l(r));return n}}class Mf extends de.PluginSettingTab{#e;#t;#n;constructor(e,n,r,i){super(e,n),this.#e=n,this.#t=r,this.#n=i}#r;async#i(){return this.#r||(this.#r=If(await this.#e.loadData())),this.#r}async#s(e){const n=await this.#i();e(n),this.#e.saveData(n)}async noteOrder(){const e=await this.#i();return await Si.sanitize(e.openWith.property,e.openWith.secondaryProperty.name,e.openWith.secondaryProperty.inUse,this.#t,async n=>{this.#s(r=>r.openWith.property=n)},async n=>{this.#s(r=>r.openWith.secondaryProperty.name=n)},async n=>{this.#s(r=>r.openWith.secondaryProperty.inUse=n)})}async noteLength(){const e=await this.#i();return{propertyName:e.openWith.secondaryProperty.name,use:e.openWith.secondaryProperty.inUse,useAs:e.openWith.secondaryProperty.useAs}}async noteFilter(){const e=await this.#i();return new Wo(this.#n,e.openWith.filter.query,async n=>{this.#s(r=>r.openWith.filter.query=n)})}#o=null;async groups(){if(this.#o)return this.#o.groups;const e=await this.#i(),n=new Vo(e.openWith.groups.map(Tn.fromSavedState)),r=n.observe(()=>{const i=n.saveState();this.#s(o=>{o.openWith.groups=i})});return this.#o={groups:n,dispose:r},this.#o.groups}usePreviousState(){return this.#r?.openWith?.previousState??!1}async display(){const e=this.containerEl,n=await this.noteOrder(),r=await this.noteLength(),i=await this.noteFilter(),o=await this.groups();new de.Setting(e).setName("Ribbon Re-opens Timeline").setDesc("When clicking the ribbon icon, should it attempt to re-open the previously closed timeline?  This is not persisted across obsidian restarts.").addToggle(p=>{p.setValue(this.usePreviousState()).onChange(v=>{this.#s(g=>g.openWith.previousState=v)})}),new de.Setting(e).setName("Defaults").setClass("setting-item-heading");const a=new DocumentFragment;a.createSpan("",p=>{p.innerText="The default property to use for ordering notes in the timeline when it's first opened."});const u=[a.createSpan("",p=>{p.addClass("mod-warning"),p.innerText=`
The selected properties are of different types and may result in nonsensical behaviour.`})];function l(){n.selectedProperty().type()===zt.Number&&n.secondaryProperty().type()!==zt.Number||n.selectedProperty().type()!==zt.Number&&n.secondaryProperty().type()===zt.Number?u.forEach(p=>p.show()):u.forEach(p=>p.hide())}const c=new de.Setting(e).setName("Default Ordering Property").setDesc(a);tn(Ps,{target:c.controlEl,props:{property:n.selectedProperty(),getProperties:()=>n.availableProperties(),tabindex:0},events:{selected:p=>{n.selectProperty(p.detail),l()}}}),new de.Setting(e).setName("Use Secondary Property").setDesc("Should a secondary property be used by default when the timeline is first opened?").addToggle(p=>{p.setValue(n.secondaryPropertyInUse()),p.onChange(v=>{n.toggleSecondaryProperty(v),this.#s(g=>g.openWith.secondaryProperty.inUse=v)})});const d=new DocumentFragment;d.createSpan("",p=>{p.innerText="The default property to use as the secondary property when the timeline is first opened."}),u.push(d.createSpan("",p=>{p.addClass("mod-warning"),p.innerText=`
The selected properties are of different types and may result in nonsensical behaviour.`}));const h=new de.Setting(e).setName("Default Secondary Property").setDesc(d);tn(Ps,{target:h.controlEl,props:{property:n.secondaryProperty(),getProperties:()=>n.availableProperties(),tabindex:0},events:{selected:p=>{n.selectSecondaryProperty(p.detail),l()}}}),l(),new de.Setting(e).setName("Interpret Secondary Property As").setDesc("By default, how should the secondary property be interpreted?").addDropdown(p=>{p.addOption("length","Length"),p.addOption("end","End"),p.setValue(r.useAs),p.onChange(v=>{r.useAs=v,this.#s(g=>g.openWith.secondaryProperty.useAs=v)})});const f=new de.Setting(e).setName("Default Filter").setDesc("The default filter to use for notes in the timeline when it's first opened.");tn(Ro,{target:f.controlEl,props:{filter:i}}),new de.Setting(e).setName("Default Groups").setDesc("The default set of groups to use in the timeline when it's first opened."),tn(No,{target:new de.Setting(e).controlEl,props:{groups:o}})}hide(){this.#o?.dispose(),this.containerEl.empty(),super.hide()}}function If(t){return Vf().parseOrDefault(t)}function Vf(){return Xe({openWith:Xe({property:Qe("created"),secondaryProperty:Xe({name:Qe("modified"),inUse:at(!1),useAs:ti({length:"length",end:"end"},"end")}),filter:Xe({query:Qe("")}),groups:Io(Xe({query:Qe(""),color:Qe("")})),previousState:at(!1)})})}function Nf(t){if(t.getViewType()!=="tag")return;const e=t.tagDoms;if(e!=null&&typeof e=="object"){for(const n of Object.values(e))if(typeof n!="object"||!("selfEl"in n)||typeof n.selfEl!="object"||!(n.selfEl instanceof HTMLElement))return;return e}}const ks=new Set("#-_/1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");function Ef(t,e){let n=e;for(n;n>=0;n--){if(!ks.has(t[n])){n++;break}if(n===0)break}let r=e;for(r;r<t.length&&ks.has(t[r]);r++);const i=t.slice(n,r);return i.startsWith("#")?i:null}class Of extends de.Plugin{async onload(){const e=new wa(this.app.vault,this.app.metadataCache,this.app.fileManager),n=new ta(()=>this.app.vault.adapter.read(de.normalizePath(".obsidian/types.json")),()=>Zo(this.app)),r=new Mf(this.app,this,n,e);this.addSettingTab(r);const i=(u,l,c)=>{u.setViewState({type:Fe.TYPE,active:!0,state:l,group:c})},o=async(u,l,c)=>{const d=(await r.noteOrder()).selectedProperty(),h=await r.noteLength(),f=await r.noteFilter(),p=await r.groups(),v=await ba(e,d,c?.filterQuery?e.getInclusiveNoteFilterForQuery(c.filterQuery):f.noteFilter());i(u,{settings:{property:{property:v.order.name(),secondaryProperty:{name:h.propertyName,inUse:h.use,useAs:h.useAs}},filter:{query:v.filter.query()},groups:{groups:p.saveState()}},focalValue:v.focalValue,isNew:!0},l)},a=u=>{o(this.app.workspace.getLeaf(!0),void 0,u)};this.registerView(Fe.TYPE,u=>new Fe(u,this.app.vault,this.app.metadataCache,this.app.workspace,this.app.fileManager,e,n)),this.addRibbonIcon(Fe.ICON,"Open timeline view",u=>{const l=Fe.getPreviouslyClosedState();if(u.button===2){const c=new de.Menu().addItem(d=>{d.setTitle("Open new timeline view").onClick(()=>{a()})});l!=null&&c.addItem(d=>{d.setTitle("Re-open closed timeline view").onClick(()=>{i(this.app.workspace.getLeaf(!0),{...l,isNew:!1})})}),c.showAtMouseEvent(u)}else r.usePreviousState()&&l!=null?i(this.app.workspace.getLeaf(!0),{...l,isNew:!1}):a()}),this.addCommand({id:"open-timeline-view",name:"Open timeline view",callback:()=>a(),icon:Fe.ICON}),this.addCommand({id:"reopen-timeline-view",name:"Re-open timeline view",checkCallback:u=>{if(u)return Fe.hasClosedState();const l=Fe.getPreviouslyClosedState();return l!=null?(i(this.app.workspace.getLeaf(!0),{...l,isNew:!1}),!0):!1},icon:Fe.ICON}),this.registerEvent(this.app.workspace.on("file-menu",(u,l,c,d)=>{l instanceof de.TFolder&&c==="file-explorer-context-menu"&&u.addItem(h=>{h.setTitle("View as timeline").setIcon(Fe.ICON).onClick(()=>{a({filterQuery:`path:"${l.path}"`})})})})),this.registerDomEvent(window,"auxclick",u=>{if(u.button!==2||!(u.target instanceof HTMLElement))return;const l=u.target.matchParent("div.tree-item-self.tag-pane-tag.is-clickable");if(!(l instanceof HTMLElement))return;const c=this.app.workspace.getLeavesOfType("tag").at(0)?.view;if(c==null)return;const d=Nf(c);if(d==null)return;const h=Object.entries(d).find(([f,p])=>p.selfEl===l);h!=null&&(u.preventDefault(),u.stopPropagation(),u.stopImmediatePropagation(),new de.Menu().addItem(f=>{f.setTitle("View notes with tag in timeline").setIcon(Fe.ICON).onClick(()=>{a({filterQuery:`tag:${h[0]}`})})}).showAtMouseEvent(u))}),this.registerEvent(this.app.workspace.on("editor-menu",(u,l,c)=>{const d=l.getCursor(),h=l.getLine(d.line),f=Ef(h,d.ch);f!=null&&u.addItem(p=>{p.setSection("selection").setTitle("View notes with tag in timeline").setIcon(Fe.ICON).onClick(async()=>{a({filterQuery:`tag:${f}`})})})})),this.registerEvent(this.app.workspace.on("search:results-menu",(u,l)=>{u.addItem(c=>{c.setSection("timeline").setTitle("Order results in new timeline view").setIcon(Fe.ICON).onClick(()=>{a({filterQuery:l.searchQuery.query})})}).addItem(c=>{c.setSection("timeline").setTitle("Save as default filter for timeline views").setIcon(Fe.ICON).onClick(async()=>{(await r.noteFilter()).filterByQuery(l.searchQuery.query)})})}))}}module.exports=Of;

/* nosourcemap */